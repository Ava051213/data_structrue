# 字符串和正则表达式

## 6.1 String类

### 基本概念
- Java没有内置字符串类型，使用`java.lang.String`类创建字符串变量
- String操作以字符(char, 2字节)为单位

### 创建字符串对象
```java
// 构造方法创建
String s = new String("we are students");

// 字符数组创建
char[] a = {'b','o','y'};
String s = new String(a);

// 截取部分字符数组
char[] a = {'s','t','b','u','s','n'};
String s = new String(a,2,3);
```

### 常用方法
| 方法                                        | 功能描述     |
| ----------------------------------------- | -------- |
| `public int length()`                     | 获取字符串长度  |
| `public boolean equals(String s)`         | 比较字符串内容  |
| `public boolean startsWith(String s)`     | 判断前缀     |
| `public boolean endsWith(String s)`       | 判断后缀     |
| `public int indexOf(String s)`            | 返回首次出现位置 |
| `public String substring(int start)`      | 获取子串     |
| `public String replaceAll(String s1, s2)` | 替换字符串    |
| `public String trim()`                    | 去除前后空格   |

### 类型转换
```java
// 字符串→基本类型
int x = Integer.parseInt("123");

// 基本类型→字符串
String s = String.valueOf(123.45);
```

### 对象的字符串表示
- 所有类默认继承`Object`，自带`toString()`方法
- 重写可自定义格式，`System.out.println(对象)`自动调用
- 示例：
```Java
class Student {
	String name;
	@Override
	public String toString() {return "学生：" + name;}
}
```

### 字符串字符数组、字节数组

| 转换方向      | 方法/构造器                                  | 功能描述                   |
| --------- | --------------------------------------- | ---------------------- |
| 字符串->字符数组 | `char[] toCharArray()`                  | 全量复制为字符数组              |
| 字符串->字符数组 | `getChars(int s,int e,char[] c,int off` | 复制[s,e-1]区间到数组c的off位置  |
| 字符数组->字符串 | `String(char[] arr)`                    | 全量字符数组构造字符串            |
| 字符数组->字符串 | `String(char[] arr,int off,int len)`    | 数组[off,off+len-1]构造字符串 |

| 转换方向      | 方法/构造器                               | 功能描述                   |
| --------- | ------------------------------------ | ---------------------- |
| 字符串->字节数组 | `byte[] getBytes()`                  | 按默认编码转为字节数组            |
| 字节数组->字符串 | `String(byte[] arr)`                 | 全量字节数构造字符串             |
| 字节数组->字符串 | `String(byte[] arr,int off,int len)` | 数组[off,off+len-1]构造字符串 |

## 6.2 StringBuffer类

### 特点
- 可修改的字符串序列（无需创建新对象）
- 线程安全(与StringBuilder对比，支持多线程同步)
- 容量自动扩容（默认初始容量16字符）

### 构造方法
```Java
StringBuffer sb1 = new StringBuffer();          // 初始容量16
StringBuffer sb2 = new StringBuffer(32);        // 指定初始容量32
StringBuffer sb3 = new StringBuffer("Hello");   // 初始容量=5+16=21
```

### 常用方法
```java
StringBuffer sb = new StringBuffer();
sb.append("Hello");       // 追加
sb.insert(5, " World");   // 插入
sb.reverse();             // 反转
sb.delete(0, 5);          // 删除
sb.setCharAt(0,'a');      // 替换
sb.replace(2,4,"xx");     // 替换
```

### 与StringBuilder对比
| 特性   | StringBuffer | StringBuilder |
| ---- | ------------ | ------------- |
| 线程安全 | 是            | 否             |
| 效率   | 较低           | 较高            |
| 适用场景 | 多线程环境        | 单线程环境         |

## 6.3 StringTokenizer类
### 功能
 - 字符串拆分工具，将字符串按分隔符分解为独立符号

### 核心用法
```Java
// 1.默认分隔符（空格、\n、\r、\t、\f）
StringTokenizer st1 = new StringTokenizer("Hello World\nJava");
while(st1.hasMoreTokens()) {
	System.out.println(st1.nextToken()); // 依次输出：Hello、World、Java
}
	
// 2.自定义分隔符（以“.,”为分隔符）
StringTokenizer st2 = new StringTokenizer("123.456,789",".,");
while(st2.hasMoreTokens()) {
	System.out.println(st2.nextToken()); // 依次输出：123、456、789
}
```

### 关键方法
| 方法                | 功能描述         |
| ----------------- | ------------ |
| `hasMoreTokens()` | 判断是否还有未拆分的符号 |
| `nextToken()`     | 逐个获取拆分后的符号   |
| `countTokens()`   | 获取剩余未获取的符号数量 |

## 6.4 正则表达式
### 核心概念
- 正则表达式：含元字符的模式字符串，用于匹配/验证特定格式的字符串
- 匹配关系：正则表达式（模式）->匹配符合格式的字符串

### 元字符表
| 元字符  | 正则写法 | 意义                   |
| ---- | ---- | -------------------- |
| `.`  | `.`  | 匹配任意单个字符（[.]匹配点号本身）  |
| `\d` | `\d` | 匹配0-9任意数字            |
| `\D` | `\D` | 匹配非数字字符              |
| `\s` | `\s` | 匹配空格、\t、\n等空白字符      |
| `\S  | `\S` | 匹配非空白字符              |
| `\w` | `\w` | 匹配字母、数字、下划线（标识符合法字符） |
| `\W` | `\W` | 匹配非标识符合法字符           |

### 限定符
| 模式       | 意义            |
| -------- | ------------- |
| `X?`     | X出现0或1次       |
| `X*`     | X出现0或多次       |
| `X+`     | X出现1或多次       |
| `X{n}`   | X出现恰好n次       |
| `X{n,}`  | X至少出现n次       |
| `X{n,m}` | X出现n~m次（含n和m） |

### 字符类
| 表达式            | 功能描述               |
| -------------- | ------------------ |
| `[abc]`        | 匹配a、b、c中任意一个字符     |
| `[^abc]`       | 匹配a、b、c外的任意字符      |
| `[a-d]`        | 匹配a~d区间的任意字符（含a、d） |
| `[a-d[m-p]]`   | 匹配a~d或m~p区间的字符（并集） |
| `[a-z&&[def]]` | 匹配d、e、f（交集）        |

### 字符串操作
```java
// 替换
String 结果 = 原字符串.replaceAll(String 正则表达式,String 替换字符串);
String result = "12hello567".replaceAll("[a-zA-Z]+", "***");

// 分解
String[] 结果数组 = 原字符串.split(String 正则表达式);
String[] words = str.split("[\\s\\d\\p{Punct}]+");

// 模式匹配
import java.util.regex.Pattern;
import java.util.regex.Matcher;

// 1.编译正则表达式为模式
Pattern pattern = Pattern.compile("\\d+"); //匹配1个以上数字
// 2.关联要匹配的字符串
Matcher matcher = pattern.matcher("2008年08月08日");
// 3.查找匹配子串
while(matcher.find()) {
	System.out.println("位置[" + matcher.start() + "-" + matcher.end() + "]：" + matcher.group());
}
```

## 6.5 Scanner类

### 核心概念
- Scanner类：java.util包下的工具类，可创建解析字符串的对象
- 作用：通过分隔符拆分字符串，筛选/提取目标数据
- 逻辑：Scanner对象->设置分隔符->拆分子串->提取有效数据

### 分隔符规则
| 类型     | 触发方式                  | 说明                 |
| ------ | --------------------- | ------------------ |
| 默认分隔符  | `new Scanner(字符串`)    | 以空白字符（空格、\t、\n等分隔） |
| 自定义分隔符 | `useDelimiter(正则表达式)` | 与正则匹配的字符/子串均为分隔标记  |
```Java
import java.util.Scanner;
import java.util.InputMismatchException;

// 1.创建Scanner对象（默认空白分隔符）
Scanner sc = new Scanner("TV cost 877 Computer cost 2398");
// 1.创建Scanner对象+设置分隔符（非数字+非小数点）
Scanner sc = new Scanner("市话费：176.89元，长途费：187.98元");
sc.useDelimiter("[^0-9.]");

// 2.遍历子串，提取金额
while (sc.hasNext()) {
	try {
		// 提取金额并打印
		System.out.println("金额：" + sc.nextDouble()); // 输出：176.89、187.98
	} catch (InputMismatchException e) {
		//跳过无效子串
		sc.next();
	}
}

// 3.关闭资源
sc.close();
```

### 核心方法
| 方法签名                          | 功能描述              | 注意事项                         |
| ----------------------------- | ----------------- | ---------------------------- |
| `Scanner(String)`             | 构造解析字符串的Scanner对象 | 源数据为字符串（非键盘输入）               |
| `boolean hasNext()`           | 判断是否有下一个拆分的子串     | 循环遍历核心条件                     |
| `double nextDouble()`         | 提取子串为double类型     | 非数字子串抛InputMismatchException |
| `String next()`               | 读取子串（字符串类型）       | 用于跳过无效子串                     |
| `Scanner useDelimiter(regex)` | 设置自定义分隔符（正则）      | 正则需精准匹配                      |
| `void close()`                | 关闭对象，释放资源         | 使用后建议调用                      |

### 异常处理
| 异常类型                     | 触发场景                         | 处理逻辑                     |
| ------------------------ | ---------------------------- | ------------------------ |
| `InputMismatchException` | `nextDouble()`遇到非数字子串，无法转为数字 | 使用try-catch捕获，使用next()跳过 |

## 6.6 模式匹配

### 核心概念
- 功能：检索/检验与指定正则模式匹配的字符串
- 核心类：`Pattern`（编译正则）、`Matcher`（执行匹配）
- 核心流程：正则表达式->`Pattern`编译->`Matcher`匹配->结果处理

### Pattern和Matcher（java.util.regex)
```java
// 1.编译正则表达式为Pattern对象
Pattern p = Pattern.compile("正则表达式");
// 2.关联待匹配字符串，创建Matcher对象
Matcher m = p.matcher("待匹配字符串");
// 3.执行匹配并处理结果（示例：查找所有匹配子串）
while(m.find()) {
    System.out.println("匹配结果：" + m.group()); // 获取匹配子串
}
```

### 匹配方法
| 方法            | 功能        | 示例效果（正则`\\d+`，字符串`"2008年08月08日"` |
| ------------- | --------- | -------------------------------- |
| `find()`      | 查找下一匹配子串  | 循环输出：2008、08、08                  |
| `matches()`   | 判断字符串完全匹配 | 返回`false`（字符串含非数字字符）             |
| `lookingAt()` | 判断字符串开头匹配 | 返回`true`（开头"2008"匹配`\\d+`）       |

### 常用结果处理方法
| 方法名                    | 功能描述        | 示例（匹配子串"2008"）          |
| ---------------------- | ----------- | ----------------------- |
| `group()`              | 返回当前匹配的子串   | 返回`"2008"`              |
| `start()`              | 返回匹配子串的起始索引 | 返回`0`                   |
| `end()`                | 返回匹配子串的结束索引 | 返回`4`                   |
| `replaceAll(String s)` | 替换所有匹配子串为s  | `"xxx年xx月xx日"`（s为"xxx"） |
