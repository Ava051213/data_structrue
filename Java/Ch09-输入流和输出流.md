# è¾“å…¥æµå’Œè¾“å‡ºæµ

> ğŸ“ **è¯¾ç¨‹**: Javaè¯­è¨€ç¨‹åºè®¾è®¡ ç¬¬ä¹ç« 
> 
> ğŸ¯ **å­¦ä¹ ç›®æ ‡**: æŒæ¡Java I/Oæµçš„æ ¸å¿ƒæ¦‚å¿µä¸æ–‡ä»¶æ“ä½œæŠ€æœ¯

---

## ğŸ“‹ ç›®å½•ç»“æ„

```mermaid
mindmap
  root((I/Oæµ))
    åŸºç¡€æ¦‚å¿µ
      è¾“å…¥æµä¸è¾“å‡ºæµ
      4å¤§æŠ½è±¡ç±»
      æµçš„åˆ†ç±»
    æ–‡ä»¶æ“ä½œ
      Fileç±»
      Scannerè§£æ
    å­—ç¬¦æµ
      FileReader/Writer
      BufferedReader/Writer
    å­—èŠ‚æµ
      FileInputStream/OutputStream
      æ•°æ®æµ
      å¯¹è±¡æµ
    é«˜çº§ç‰¹æ€§
      éšæœºè¯»å†™æµ
      æ–‡ä»¶é”
      åºåˆ—åŒ–
```

**ç« èŠ‚åˆ—è¡¨**:

1. æ–‡ä»¶ (Fileç±»)
2. ä½¿ç”¨Scannerè§£ææ–‡ä»¶
3. æ–‡ä»¶å­—ç¬¦æµ
4. ç¼“å†²æµ
5. æ–‡ä»¶å­—èŠ‚æµ
6. æ•°æ®æµ
7. å¯¹è±¡æµ
8. åºåˆ—åŒ–å’Œå¯¹è±¡å…‹éš†
9. æ•°ç»„æµ
10. å­—ç¬¦ä¸²æµ
11. éšæœºè¯»å†™æµ
12. æ–‡ä»¶é”

---

## ğŸ” å¼•è¨€

### ğŸ’¡ I/Oæµçš„åŸºæœ¬æ¦‚å¿µ

**å®šä¹‰**:
- è¯»å†™æ–‡ä»¶æ—¶å¯ä»¥ä½¿ç”¨è¾“å…¥/è¾“å‡ºæµï¼Œç®€ç§°**I/O (input/output) æµ**
- è¾“å…¥æµ (input stream)ï¼šç¨‹åºä»æºè¯»å–æ•°æ®
- è¾“å‡ºæµ (output stream)ï¼šç¨‹åºå‘ç›®çš„åœ°å†™å…¥æ•°æ®

**æµçš„æºå’Œç›®çš„åœ°**:

| ç±»å‹ | å¯èƒ½çš„æº/ç›®çš„åœ° |
|------|----------------|
| è¾“å…¥æµçš„æº | æ–‡ä»¶ã€é”®ç›˜ã€é¼ æ ‡ã€å†…å­˜ã€ç½‘ç»œ |
| è¾“å‡ºæµçš„ç›®çš„åœ° | æ–‡ä»¶ã€æ˜¾ç¤ºå™¨çª—å£ã€å†…å­˜ã€ç½‘ç»œ |

> ğŸ’¡ **æœ€ä½³å®è·µ**: æ˜¾å¼åœ°å…³é—­ä»»ä½•ä¸€ä¸ªæ‰“å¼€çš„æµæ˜¯ä¸€ä¸ªå¥½çš„ç¼–ç¨‹ä¹ æƒ¯

### ğŸ·ï¸ Java I/Oçš„4å¤§æŠ½è±¡ç±»

**java.ioåŒ…ä¸­çš„æ ¸å¿ƒæŠ½è±¡ç±»**:

```mermaid
graph TD
    A[java.io] --> B[InputStream<br/>å­—èŠ‚è¾“å…¥æµ]
    A --> C[OutputStream<br/>å­—èŠ‚è¾“å‡ºæµ]
    A --> D[Reader<br/>å­—ç¬¦è¾“å…¥æµ]
    A --> E[Writer<br/>å­—ç¬¦è¾“å‡ºæµ]
```

| æŠ½è±¡ç±» | ç±»å‹ | å¤„ç†å•å…ƒ |
|--------|------|---------|
| `InputStream` | å­—èŠ‚è¾“å…¥æµ | å­—èŠ‚ (byte) |
| `OutputStream` | å­—èŠ‚è¾“å‡ºæµ | å­—èŠ‚ (byte) |
| `Reader` | å­—ç¬¦è¾“å…¥æµ | å­—ç¬¦ (char) |
| `Writer` | å­—ç¬¦è¾“å‡ºæµ | å­—ç¬¦ (char) |

### ğŸ“Š æ–‡æœ¬æ–‡ä»¶ vs äºŒè¿›åˆ¶æ–‡ä»¶

| ç‰¹æ€§   | æ–‡æœ¬æ–‡ä»¶                 | äºŒè¿›åˆ¶æ–‡ä»¶                    |
| ---- | -------------------- | ------------------------ |
| æ•°æ®è¡¨ç¤º | äººç±»å¯è¯»å½¢å¼ (ASCII/UTF-8) | äºŒè¿›åˆ¶å½¢å¼                    |
| å¤„ç†æ•ˆç‡ | è¾ƒä½ (éœ€è¦ç¼–ç /è§£ç )         | è¾ƒé«˜                       |
| é€‚ç”¨åœºæ™¯ | æ–‡æœ¬ç¼–è¾‘å™¨åˆ›å»ºçš„æ–‡ä»¶           | Javaç¨‹åºåˆ›å»ºçš„æ•°æ®æ–‡ä»¶            |
| æ¨èæµ  | Reader/Writer        | InputStream/OutputStream |

> ğŸ“Œ **å‚è€ƒèµ„æº**: [Oracle Java I/O Tutorial](https://docs.oracle.com/javase/tutorial/essential/io/)

---

## ğŸ” 9.1 æ–‡ä»¶

### ğŸ·ï¸ Fileç±»æ¦‚è¿°

**æ ¸å¿ƒç‰¹ç‚¹**:
- Fileç±»ç”¨äº**è·å–æ–‡ä»¶æœ¬èº«çš„ä¿¡æ¯**ï¼ˆç›®å½•ã€é•¿åº¦ã€æƒé™ç­‰ï¼‰
- **ä¸æ¶‰åŠ**æ–‡ä»¶çš„è¯»å†™æ“ä½œ
- ä½äº`java.io`åŒ…

### ğŸ› ï¸ æ„é€ æ–¹æ³•

```java
// æ–¹å¼1: ç›´æ¥æŒ‡å®šæ–‡ä»¶åï¼ˆæ¨èä½¿ç”¨"/"ä½œä¸ºåˆ†éš”ç¬¦ï¼‰
File file1 = new File("C:/ch8/hello.txt");

// æ–¹å¼2: åˆ†åˆ«æŒ‡å®šç›®å½•å’Œæ–‡ä»¶å
File file2 = new File("C:/ch8", "hello.txt");

// æ–¹å¼3: ä½¿ç”¨Fileå¯¹è±¡ä½œä¸ºç›®å½•
File dir = new File("C:/ch8");
File file3 = new File(dir, "hello.txt");
```

> âš ï¸ **è·¯å¾„åˆ†éš”ç¬¦æ³¨æ„**:
> - âœ… æ¨è: `"C:/ch8"` (è·¨å¹³å°)
> - âœ… å¯ç”¨: `"C:\\ch8"` (éœ€è¦è½¬ä¹‰)
> - âŒ é”™è¯¯: `"C:\ch8"` (è½¬ä¹‰é”™è¯¯)

### ğŸ“Œ æ–‡ä»¶å±æ€§æ–¹æ³•

#### åŸºæœ¬ä¿¡æ¯

| æ–¹æ³• | è¿”å›ç±»å‹ | åŠŸèƒ½ |
|------|---------|------|
| `getName()` | `String` | è·å–æ–‡ä»¶å |
| `getAbsolutePath()` | `String` | è·å–ç»å¯¹è·¯å¾„ |
| `getParent()` | `String` | è·å–çˆ¶ç›®å½• |
| `length()` | `long` | è·å–æ–‡ä»¶é•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ |
| `lastModified()` | `long` | è·å–æœ€åä¿®æ”¹æ—¶é—´ |

#### æƒé™ä¸çŠ¶æ€

| æ–¹æ³• | è¿”å›ç±»å‹ | åŠŸèƒ½ |
|------|---------|------|
| `exists()` | `boolean` | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ |
| `canRead()` | `boolean` | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯è¯» |
| `canWrite()` | `boolean` | åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯å†™ |
| `isFile()` | `boolean` | åˆ¤æ–­æ˜¯å¦æ˜¯æ™®é€šæ–‡ä»¶ |
| `isDirectory()` | `boolean` | åˆ¤æ–­æ˜¯å¦æ˜¯ç›®å½• |
| `isHidden()` | `boolean` | åˆ¤æ–­æ˜¯å¦æ˜¯éšè—æ–‡ä»¶ |

### ğŸ“ ç›®å½•æ“ä½œ

#### åˆ›å»ºç›®å½•

```java
File dir = new File("C:/myFolder");
boolean success = dir.mkdir();  // åˆ›å»ºå•çº§ç›®å½•
// æˆ–
boolean success = dir.mkdirs(); // åˆ›å»ºå¤šçº§ç›®å½•
```

#### åˆ—å‡ºç›®å½•å†…å®¹

**è¿”å›å­—ç¬¦ä¸²æ•°ç»„**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `String[] list()` | è¿”å›ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å |
| `String[] list(FilenameFilter ff)` | è¿”å›æŒ‡å®šç±»å‹çš„æ–‡ä»¶å |

**è¿”å›Fileå¯¹è±¡æ•°ç»„**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `File[] listFiles()` | è¿”å›ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å¯¹è±¡ |
| `File[] listFiles(FilenameFilter ff)` | è¿”å›æŒ‡å®šç±»å‹çš„æ–‡ä»¶å¯¹è±¡ |

### ğŸ”§ æ–‡ä»¶åˆ›å»ºä¸åˆ é™¤

**åˆ›å»ºæ–°æ–‡ä»¶**:

```java
File file = new File("C:/myletter", "letter.txt");

if (!file.exists()) {
    file.createNewFile();  // åˆ›å»ºæ–°æ–‡ä»¶
} else {
    // æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ‰“å¼€è¯¥æ–‡ä»¶
}
```

**åˆ é™¤æ–‡ä»¶**:

```java
boolean deleted = file.delete();  // åˆ é™¤æ–‡ä»¶
```

> ğŸ’¡ **å·¥ä½œæµç¨‹**:
> 1. å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ â†’ è°ƒç”¨`createNewFile()`åˆ›å»º
> 2. å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ â†’ ç›´æ¥æ‰“å¼€
> 3. åˆ é™¤æ–‡ä»¶ â†’ è°ƒç”¨`delete()`

### ğŸ’» æ–‡ä»¶è¿‡æ»¤å™¨ç¤ºä¾‹

#### FilenameFilteræ¥å£å®ç°

```java
import java.io.*;

class FileAccept implements FilenameFilter {
    String str = null;
    
    FileAccept(String s) {
        str = "." + s;  // æ·»åŠ æ–‡ä»¶æ‰©å±•åå‰ç¼€
    }
    
    @Override
    public boolean accept(File dir, String name) {
        return name.endsWith(str);  // åˆ¤æ–­æ–‡ä»¶åæ˜¯å¦ä»¥æŒ‡å®šæ‰©å±•åç»“å°¾
    }
}
```

#### ä½¿ç”¨ç¤ºä¾‹

```java
public class Example9_1 {
    public static void main(String args[]) {
        // åˆ›å»ºç›®å½•å¯¹è±¡
        File dir = new File("C:/ch8");
        
        // åˆ›å»ºæ–‡ä»¶è¿‡æ»¤å™¨ï¼ˆåªæ¥å—.javaæ–‡ä»¶ï¼‰
        FileAccept fileAccept = new FileAccept("java");
        File[] files = dir.listFiles(fileAccept);
        
        // éå†å¹¶æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
        for (int i = 0; i < files.length; i++) {
            System.out.println(files[i].getName() + ": " + 
                             files[i].length() + " bytes");
        }
        
        // åˆ é™¤ç¬¬ä¸€ä¸ªæ–‡ä»¶
        boolean flag = false;
        if (files.length > 0) {
            flag = files[0].delete();
        }
        
        if (flag) {
            System.out.println(files[0].getName() + " has been deleted.");
        }
    }
}
```

### ğŸš€ è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶

**ä½¿ç”¨Runtimeç±»**:

```java
import java.io.*;

public class Example9_2 {
    public static void main(String args[]) {
        try {
            // è·å–Runtimeå¯¹è±¡
            Runtime rt = Runtime.getRuntime();
            
            // åˆ›å»ºæ–‡ä»¶å¯¹è±¡
            File file = new File("C:\\windows", "Notepad.exe");
            
            // æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶
            rt.exec(file.getAbsolutePath());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

```Java
// å®‰å…¨è­¦ç¤ºï¼šRuntime.exec() æ‰§è¡Œå¤–éƒ¨ç¨‹åºå±äºé«˜å±æ“ä½œ

import java.io.*;
import java.nio.file.*;
import java.util.*;
import java.util.concurrent.TimeUnit;

public class SafeExec {

    // TODOï¼šåªæ”¹è¿™é‡Œï¼ç»å¯¹è·¯å¾„ç™½åå•ï¼ˆå¿…é¡»å†™å®Œæ•´è·¯å¾„ï¼‰
    private static final Set<String> WHITE_LIST = Set.of(
        "C:\\Windows\\System32\\notepad.exe",
        "C:\\Windows\\System32\\calc.exe",
        "C:\\Windows\\System32\\mspaint.exe",
        "C:\\Program Files\\Git\\bin\\git.exe",
        "D:\\Tools\\ffmpeg.exe"
        // éœ€è¦åŠ åˆ«çš„ï¼Ÿç»§ç»­å¾€è¿™é‡Œå†™ä¸€è¡Œ
    );

    /** å®‰å…¨æ‰§è¡Œå¤–éƒ¨ç¨‹åº */
    public static boolean run(String exePath, String... args) {
        String absolute = Path.of(exePath).toAbsolutePath().normalize().toString();

        // 1. ç™½åå•æ ¡éªŒ
        if (!WHITE_LIST.contains(absolute)) {
            System.err.println("[å®‰å…¨æ‹’ç»] ä¸å…è®¸æ‰§è¡Œ â†’ " + absolute);
            return false;
        }

        // 2. æ–‡ä»¶å­˜åœ¨æ€§æ ¡éªŒ
        if (!Files.isRegularFile(Path.of(absolute))) {
            System.err.println("[å®‰å…¨æ‹’ç»] æ–‡ä»¶ä¸å­˜åœ¨æˆ–ä¸æ˜¯æ­£å¸¸æ–‡ä»¶");
            return false;
        }

        try {
            List<String> command = new ArrayList<>();
            command.add(absolute);
            if (args != null) command.addAll(Arrays.asList(args));

            ProcessBuilder pb = new ProcessBuilder(command);
            pb.inheritIO();                          // è¾“å‡ºç›´æ¥æ˜¾ç¤ºåœ¨æ§åˆ¶å°

            Process p = pb.start();

            // 3. è¶…æ—¶è‡ªåŠ¨æ€æ­»ï¼ˆé˜²æ­¢æŒ–çŸ¿ç¨‹åºå¸¸é©»ï¼‰
            boolean ok = p.waitFor(30, TimeUnit.SECONDS);
            if (!ok) {
                p.destroyForcibly();
                System.err.println("[å¼ºåˆ¶ç»ˆæ­¢] ç¨‹åºè¿è¡Œè¶…æ—¶");
                return false;
            }
            return p.exitValue() == 0;

        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
    }

    public static void main(String[] args) {
        run("C:\\Windows\\System32\\notepad.exe");     // æˆåŠŸ
        run("D:\\Temp\\test01.exe");                  // è¢«ç™½åå•æ‹’ç»
    }
}
```

**Runtimeç±»æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `Runtime.getRuntime()` | è·å–Runtimeå®ä¾‹ï¼ˆé™æ€æ–¹æ³•ï¼‰ |
| `exec(String command)` | æ‰§è¡Œæœ¬åœ°å¯æ‰§è¡Œæ–‡ä»¶æˆ–æ“ä½œ |

---

## ğŸ” 9.12 ä½¿ç”¨Scannerè§£ææ–‡ä»¶

### ğŸ·ï¸ è§£æç­–ç•¥

**ä¸¤ç§ç­–ç•¥å¯¹æ¯”**:

| ç­–ç•¥ | ä¼˜ç‚¹ | ç¼ºç‚¹ | ç‰¹ç‚¹ |
|------|------|------|------|
| å…¨éƒ¨è¯»å…¥å†…å­˜ | å¤„ç†é€Ÿåº¦å¿« | æ¶ˆè€—å†…å­˜å¤š | "ä»¥ç©ºé—´æ¢æ—¶é—´" |
| Scanneré€æ­¥è§£æ | èŠ‚çœå†…å­˜ | å¤„ç†é€Ÿåº¦è¾ƒæ…¢ | "ä»¥æ—¶é—´æ¢ç©ºé—´" |

### ğŸ“Œ 1. ä½¿ç”¨é»˜è®¤åˆ†éš”ç¬¦è§£æ

**åŸºæœ¬ç”¨æ³•**:

```java
File file = new File("hello.txt");
Scanner scanner = new Scanner(file);

while (scanner.hasNext()) {
    String word = scanner.next();  // è¯»å–ä¸‹ä¸€ä¸ªå•è¯ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
    System.out.println(word);
}
```

```Java
// æ¨¡æ¿1ï¼šæ–‡ä»¶æ”¾é¡¹ç›®æ ¹ç›®å½•
try (Scanner sc = new Scanner(new File("hello.txt"), "UTF-8")) {
	// 1. try-with-resources â†’ è‡ªåŠ¨å…³é—­ï¼Œç»ä¸æ³„éœ² 
	// 2. æŒ‡å®š UTF-8 â†’ ä¸­æ–‡æ°¸ä¸ä¹±ç  
	// 3. æ–‡ä»¶æ”¾é¡¹ç›®æ ¹ç›®å½•ï¼ˆå’Œ src åŒçº§ï¼‰
	
    while (sc.hasNextLine()) {
        System.out.println(sc.nextLine());
    }
} catch (FileNotFoundException e) {
    System.err.println("æ‰¾ä¸åˆ°æ–‡ä»¶ï¼è·¯å¾„ï¼š" + System.getProperty("user.dir"));
}

// æ¨¡æ¿2ï¼šæ–‡ä»¶æ”¾ src æˆ– resources
try (Scanner sc = new Scanner(
        Objects.requireNonNull(
            getClass().getClassLoader().getResourceAsStream("hello.txt")),
        StandardCharsets.UTF_8)) {

    while (sc.hasNextLine()) System.out.println(sc.nextLine());

} catch (Exception e) {
    System.err.println("è¯»å–å¤±è´¥ï¼š" + e.getMessage());
}
```

**Scannerå¸¸ç”¨æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ | è¿”å›ç±»å‹ |
|------|------|---------|
| `hasNext()` | åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå…ƒç´  | `boolean` |
| `next()` | è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸² | `String` |
| `nextInt()` | è¯»å–ä¸‹ä¸€ä¸ªæ•´æ•° | `int` |
| `nextDouble()` | è¯»å–ä¸‹ä¸€ä¸ªæµ®ç‚¹æ•° | `double` |

> âš ï¸ **å¼‚å¸¸å¤„ç†**: å¦‚æœè°ƒç”¨`nextInt()`æˆ–`nextDouble()`æ—¶å•è¯ä¸æ˜¯æ•°å­—ï¼Œä¼šæŠ›å‡º`InputMismatchException`

### ğŸ’» ç¤ºä¾‹: è§£ææ¶ˆè´¹æ•°æ®

**æ–‡ä»¶å†…å®¹** (cost.txt):
```
TV cost 876 dollar, Computer cost 2398 dollar. 
The milk cost 98 dollar. The apple cost 198 dollar.
```

**ä»£ç å®ç°**:

```java
import java.io.*;
import java.util.*;

public class Demo {
    public static void main(String args[]) {
        File file = new File("D:\\chp09\\cost.txt");
        Scanner scanner = null;
        int sum = 0;
        
        try {
            scanner = new Scanner(file);
            
            while (scanner.hasNext()) {
                try {
                    int price = scanner.nextInt();  // å°è¯•è¯»å–æ•´æ•°
                    sum += price;
                    System.out.println(price);
                } catch (InputMismatchException exp) {
                    String t = scanner.next();  // è·³è¿‡éæ•°å­—å•è¯
                }
            }
            
            System.out.println("Total Cost: " + sum + " dollar");
        } catch (Exception exp) {
            System.out.println(exp);
        }
    }
}
```

**è¾“å‡ºç»“æœ**:
```
876
2398
98
198
Total Cost: 3570 dollar
```

### ğŸ“Œ 2. ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä½œä¸ºåˆ†éš”ç¬¦

**è¯­æ³•**:

```java
File file = new File("hello.txt");
Scanner scanner = new Scanner(file);
scanner.useDelimiter(æ­£åˆ™è¡¨è¾¾å¼);  // è®¾ç½®è‡ªå®šä¹‰åˆ†éš”ç¬¦
```

### ğŸ’» ç¤ºä¾‹: è§£æé€šä¿¡è´¹ç”¨

**æ–‡ä»¶å†…å®¹** (communicate.txt):
```
å¸‚è¯è´¹:176.89å…ƒ,é•¿é€”è´¹:187.98å…ƒ,ç½‘ç»œè´¹:928.66å…ƒ
```

**ä»£ç å®ç°**:

```java
import java.io.*;
import java.util.*;

public class Demo {
    public static void main(String args[]) {
        File file = new File("D:\\chp09\\communicate.txt");
        Scanner scanner = null;
        double sum = 0;
        
        try {
            scanner = new Scanner(file);
            // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼šåŒ¹é…æ‰€æœ‰éæ•°å­—å­—ç¬¦ä½œä¸ºåˆ†éš”ç¬¦
            scanner.useDelimiter("[^0123456789.]+");
            
            while (scanner.hasNextDouble()) {
                double fare = scanner.nextDouble();
                sum += fare;
                System.out.println(fare);
            }
            
            System.out.println("Total: " + sum);
        } catch (Exception exp) {
            System.out.println(exp);
        }
    }
}
```

**è¾“å‡ºç»“æœ**:
```
176.89
187.98
928.66
Total: 1293.53
```

**æ­£åˆ™è¡¨è¾¾å¼è¯´æ˜**:

| æ­£åˆ™è¡¨è¾¾å¼ | å«ä¹‰ |
|-----------|------|
| `[^0123456789.]+` | åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéæ•°å­—å­—ç¬¦ï¼ˆä¸åŒ…æ‹¬å°æ•°ç‚¹ï¼‰ |
| `[^a-zA-Z]+` | åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå­—æ¯å­—ç¬¦ |
| `\\s+` | åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªç©ºç™½å­—ç¬¦ |

### ğŸ“Œ 3. å•è¯è®°å¿†è®­ç»ƒåº”ç”¨

**åŠŸèƒ½éœ€æ±‚**:
1. ä»æ–‡ä»¶word.txtè¯»å–è‹±æ–‡å•è¯ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
2. æ˜¾ç¤ºå•è¯åè¦æ±‚ç”¨æˆ·è¾“å…¥
3. ç”¨æˆ·è¾“å…¥æ—¶éšè—æ˜¾ç¤ºçš„å•è¯
4. ç»Ÿè®¡æ­£ç¡®ç‡

---

## ğŸ” 9.3 æ–‡ä»¶å­—ç¬¦æµ

### ğŸ·ï¸ FileReaderç±»

**æ„é€ æ–¹æ³•**:

```java
// æ–¹å¼1: é€šè¿‡æ–‡ä»¶ååˆ›å»º
FileReader reader = new FileReader("hello.txt");

// æ–¹å¼2: é€šè¿‡Fileå¯¹è±¡åˆ›å»º
File file = new File("hello.txt");
FileReader reader = new FileReader(file);
```

**å¸¸ç”¨æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ | è¿”å›å€¼ |
|------|------|--------|
| `int read()` | è¯»å–ä¸€ä¸ªå­—ç¬¦ | 0~65535 (Unicodeå€¼)ï¼Œæœ«å°¾è¿”å›-1 |
| `int read(char[] b)` | è¯»å–b.lengthä¸ªå­—ç¬¦åˆ°æ•°ç»„b | å®é™…è¯»å–çš„å­—ç¬¦æ•°ï¼Œæœ«å°¾è¿”å›-1 |
| `int read(char[] b, int off, int len)` | è¯»å–lenä¸ªå­—ç¬¦åˆ°æ•°ç»„bï¼Œä»offä½ç½®å¼€å§‹å­˜æ”¾ | å®é™…è¯»å–çš„å­—ç¬¦æ•°ï¼Œæœ«å°¾è¿”å›-1 |

> ğŸ’¡ **ç¼–ç è¯´æ˜**: 
> - Javaå†…éƒ¨ä½¿ç”¨2å­—èŠ‚UTF-16ç¼–ç è¡¨ç¤ºå­—ç¬¦
> - æ–‡ä»¶ä¸­çš„ç‰©ç†å­—èŠ‚æ•°å¯èƒ½æ˜¯1ã€2æˆ–3ä¸ªå­—èŠ‚

### ğŸ·ï¸ FileWriterç±»

**æ„é€ æ–¹æ³•**:

```java
// æ–¹å¼1: é€šè¿‡æ–‡ä»¶ååˆ›å»º
FileWriter writer = new FileWriter("hello.txt");

// æ–¹å¼2: é€šè¿‡Fileå¯¹è±¡åˆ›å»º
File file = new File("hello.txt");
FileWriter writer = new FileWriter(file);
```

**å¸¸ç”¨æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `void write(char[] b)` | å†™å…¥æ•´ä¸ªå­—ç¬¦æ•°ç»„ |
| `void write(char[] b, int off, int len)` | å†™å…¥æ•°ç»„çš„ä¸€éƒ¨åˆ† |
| `void write(String str)` | å†™å…¥æ•´ä¸ªå­—ç¬¦ä¸² |
| `void write(String str, int off, int len)` | å†™å…¥å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ† |

### ğŸ’» ä»£ç ç¤ºä¾‹

```java
import java.io.*;

public class Example9_4 {
    public static void main(String args[]) {
        File file = new File("hello.txt");
        char b[] = "æ·±åœ³å¤§å­¦".toCharArray();
        
        try {
            // å†™å…¥æ•°æ®
            FileWriter output = new FileWriter(file);
            output.write(b);              // å†™å…¥å­—ç¬¦æ•°ç»„
            output.write("è„šè¸å®åœ°ï¼");    // å†™å…¥å­—ç¬¦ä¸²
            output.close();
            
            // è¯»å–æ•°æ®
            FileReader input = new FileReader(file);
            int n = 0;
            while ((n = input.read(b, 0, 2)) != -1) {  // æ¯æ¬¡æœ€å¤šè¯»2ä¸ªå­—ç¬¦
                String str = new String(b, 0, n);      // è½¬æ¢ä¸ºå­—ç¬¦ä¸²
                System.out.println(str);
            }
            input.close();
        } catch (IOException e) {
            System.out.println(e);
        }
    }
}
```

**è¾“å‡ºç»“æœ**:
```
æ·±åœ³
å¤§å­¦
è„šè¸
å®åœ°
ï¼
```

---

## ğŸ” 9.5 ç¼“å†²æµ

### ğŸ·ï¸ BufferedReaderç±»

**æ„é€ æ–¹æ³•**:

```java
FileReader fr = new FileReader("Student.txt");
BufferedReader input = new BufferedReader(fr);
```

**æ ¸å¿ƒæ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ | è¿”å›ç±»å‹ |
|------|------|---------|
| `String readLine()` | è¯»å–ä¸€è¡Œæ–‡æœ¬ | `String`ï¼Œæœ«å°¾è¿”å›`null` |

**å·¥ä½œæµç¨‹**:

```mermaid
graph LR
    A[æ–‡ä»¶] --> B[FileReader]
    B --> C[BufferedReader]
    C --> D[readLineæ–¹æ³•]
    D --> E[é€è¡Œè¯»å–]
```

### ğŸ·ï¸ BufferedWriterç±»

**æ„é€ æ–¹æ³•**:

```java
FileWriter fw = new FileWriter("hello.txt");
BufferedWriter output = new BufferedWriter(fw);
```

**å¸¸ç”¨æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `write(String s)` | å†™å…¥æ•´ä¸ªå­—ç¬¦ä¸² |
| `write(String s, int off, int len)` | å†™å…¥å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ† |
| `newLine()` | å†™å…¥è¡Œåˆ†éš”ç¬¦ |
| `flush()` | åˆ·æ–°ç¼“å†²åŒº |

### ğŸ’» ä»£ç ç¤ºä¾‹

```java
import java.io.*;

public class Example9_5 {
    public static void main(String args[]) {
        try {
            // åˆ›å»ºè¾“å…¥æµ
            FileReader fr = new FileReader("input.txt");
            BufferedReader input = new BufferedReader(fr);
            
            // åˆ›å»ºè¾“å‡ºæµ
            FileWriter fw = new FileWriter("output.txt");
            BufferedWriter output = new BufferedWriter(fw);
            
            // é€è¡Œè¯»å–å¹¶æ·»åŠ è¡Œå·
            String s = null;
            int i = 0;
            while ((s = input.readLine()) != null) {
                i++;
                output.write(i + ": " + s);
                output.newLine();  // å†™å…¥æ¢è¡Œç¬¦
            }
            
            // å…³é—­æµ
            output.flush();
            output.close();
            fw.close();
            input.close();
            fr.close();
        } catch (IOException e) {
            System.out.println(e);
        }
    }
}
```

**åŠŸèƒ½**: ä¸ºæ–‡æœ¬æ–‡ä»¶çš„æ¯ä¸€è¡Œæ·»åŠ è¡Œå·

---

## ğŸ” 9.2 æ–‡ä»¶å­—èŠ‚æµ

### ğŸ·ï¸ FileInputStreamç±»

**æ„é€ æ–¹æ³•**:

```java
// æ–¹å¼1: é€šè¿‡æ–‡ä»¶ååˆ›å»º
FileInputStream fis = new FileInputStream("hello.txt");

// æ–¹å¼2: é€šè¿‡Fileå¯¹è±¡åˆ›å»º
File file = new File("hello.txt");
FileInputStream fis = new FileInputStream(file);
```

**æ ¸å¿ƒæ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ | è¿”å›å€¼ |
|------|------|--------|
| `int read()` | è¯»å–å•ä¸ªå­—èŠ‚ | 0~255ï¼Œæœ«å°¾è¿”å›-1 |
| `int read(byte[] b)` | è¯»å–b.lengthä¸ªå­—èŠ‚åˆ°æ•°ç»„b | å®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼Œæœ«å°¾è¿”å›-1 |
| `int read(byte[] b, int off, int len)` | è¯»å–lenä¸ªå­—èŠ‚åˆ°æ•°ç»„bï¼Œä»offä½ç½®å¼€å§‹å­˜æ”¾ | å®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼Œæœ«å°¾è¿”å›-1 |

### ğŸ·ï¸ FileOutputStreamç±»

**æ„é€ æ–¹æ³•**:

```java
// æ–¹å¼1: é€šè¿‡æ–‡ä»¶ååˆ›å»º
FileOutputStream fos = new FileOutputStream("hello.txt");

// æ–¹å¼2: é€šè¿‡Fileå¯¹è±¡åˆ›å»º
File file = new File("hello.txt");
FileOutputStream fos = new FileOutputStream(file);
```

**å¸¸ç”¨æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `void write(byte[] b)` | å†™å…¥æ•´ä¸ªå­—èŠ‚æ•°ç»„ |
| `void write(byte[] b, int off, int len)` | å†™å…¥æ•°ç»„çš„ä¸€éƒ¨åˆ† |

### ğŸ’» ä»£ç ç¤ºä¾‹

```java
import java.io.*;

public class Example9_3 {
    public static void main(String args[]) {
        File file = new File("hello.txt");
        byte b[] = "æ·±åœ³å¤§å­¦".getBytes();
        
        try {
            // å†™å…¥æ•°æ®
            FileOutputStream output = new FileOutputStream(file);
            output.write(b);  // å†™å…¥å­—èŠ‚æ•°ç»„
            output.close();
            
            // è¯»å–æ•°æ®
            FileInputStream input = new FileInputStream(file);
            int n = 0;
            while ((n = input.read(b, 0, 3)) != -1) {  
                // æœ€å¤šè¯»3ä¸ªå­—èŠ‚ï¼ˆæ–‡ä»¶ä¸­çš„ç‰©ç†å­—èŠ‚æ•°ï¼‰
                // è¯»åˆ°å†…å­˜åç»Ÿä¸€ç”¨2ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªæ±‰å­—
                String str = new String(b, 0, n);
                System.out.println(str);
            }
        } catch (IOException e) {
            System.out.println(e);
        }
    }
}
```

> ğŸ’¡ **ç¼–ç è¯´æ˜**:
> - æ–‡ä»¶ä¸­: ç‰©ç†å­—èŠ‚æ•°å¯èƒ½æ˜¯1ã€2æˆ–3ä¸ªå­—èŠ‚ï¼ˆå–å†³äºç¼–ç ï¼‰
> - å†…å­˜ä¸­: Javaç»Ÿä¸€ç”¨2ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼ˆUTF-16ï¼‰

---

## ğŸ” 9.8 æ•°æ®æµ

### ğŸ·ï¸ DataInputStreamç±»å’ŒDataOutputStreamç±»

**æ ¸å¿ƒç‰¹ç‚¹**:
- DataInputStream: æ•°æ®è¾“å…¥æµ
- DataOutputStream: æ•°æ®è¾“å‡ºæµ
- å¯ä»¥è¯»å†™JavaåŸºæœ¬æ•°æ®ç±»å‹

**æ„é€ æ–¹æ³•**:

```java
// æ•°æ®è¾“å…¥æµ
FileInputStream fis = new FileInputStream("jerry.dat");
DataInputStream input = new DataInputStream(fis);

// æ•°æ®è¾“å‡ºæµ
FileOutputStream fos = new FileOutputStream("jerry.dat");
DataOutputStream output = new DataOutputStream(fos);
```

### ğŸ“Š å¸¸ç”¨æ–¹æ³•

**DataOutputStreamå†™å…¥æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `writeInt(int v)` | å†™å…¥intå€¼ |
| `writeDouble(double v)` | å†™å…¥doubleå€¼ |
| `writeBoolean(boolean v)` | å†™å…¥booleanå€¼ |
| `writeChar(int v)` | å†™å…¥charå€¼ |
| `writeChars(String s)` | å†™å…¥å­—ç¬¦ä¸² |
| `writeUTF(String s)` | ä»¥UTF-8æ ¼å¼å†™å…¥å­—ç¬¦ä¸² |

**DataInputStreamè¯»å–æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `int readInt()` | è¯»å–intå€¼ |
| `double readDouble()` | è¯»å–doubleå€¼ |
| `boolean readBoolean()` | è¯»å–booleanå€¼ |
| `char readChar()` | è¯»å–charå€¼ |
| `String readUTF()` | è¯»å–UTF-8æ ¼å¼å­—ç¬¦ä¸² |

### ğŸ’» ä»£ç ç¤ºä¾‹

```java
import java.io.*;

public class Example9_8 {
    public static void main(String args[]) {
        try {
            // å†™å…¥æ•°æ®
            FileOutputStream fos = new FileOutputStream("jerry.dat");
            DataOutputStream output = new DataOutputStream(fos);
            output.writeInt(100);
            output.writeChars("I am ok");
            output.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
        
        try {
            // è¯»å–æ•°æ®
            FileInputStream fis = new FileInputStream("jerry.dat");
            DataInputStream input = new DataInputStream(fis);
            
            System.out.println(input.readInt());  // è¾“å‡º: 100
            
            char c;
            while ((c = input.readChar()) != '\0') {  // '\0'è¡¨ç¤ºç©ºå­—ç¬¦
                System.out.print(c);  // è¾“å‡º: I am ok
            }
            input.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

---

## ğŸ” 9.9 å¯¹è±¡æµ

### ğŸ·ï¸ ObjectInputStreamå’ŒObjectOutputStream

**æ ¸å¿ƒç‰¹ç‚¹**:
- ObjectInputStream: å¯¹è±¡è¾“å…¥æµ
- ObjectOutputStream: å¯¹è±¡è¾“å‡ºæµ
- å¯ä»¥è¯»å†™æ•´ä¸ªå¯¹è±¡

**æ„é€ æ–¹æ³•**:

```java
// å¯¹è±¡è¾“å…¥æµ
FileInputStream fis = new FileInputStream("a.txt");
ObjectInputStream objectIn = new ObjectInputStream(fis);

// å¯¹è±¡è¾“å‡ºæµ
FileOutputStream fos = new FileOutputStream("a.txt");
ObjectOutputStream objectOut = new ObjectOutputStream(fos);
```

**æ ¸å¿ƒæ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `writeObject(Object obj)` | å°†å¯¹è±¡objå†™å…¥è¾“å‡ºæµ |
| `Object readObject()` | ä»è¾“å…¥æµè¯»å–ä¸€ä¸ªå¯¹è±¡ |

### ğŸ” Serializableæ¥å£

**åºåˆ—åŒ–çš„å®šä¹‰**:
- ä¸€ä¸ªç±»å¦‚æœå®ç°äº†`Serializable`æ¥å£ï¼Œè¯¥ç±»åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯**åºåˆ—åŒ–å¯¹è±¡** (serializable object)
- Serializableæ¥å£ä¸­çš„æ–¹æ³•å¯¹ç¨‹åºä¸å¯è§
- å®ç°è¯¥æ¥å£çš„ç±»ä¸éœ€è¦å®ç°é¢å¤–çš„æ–¹æ³•
- JVMä¼šè‡ªåŠ¨å¤„ç†åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹

**ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–**:
- å°†å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµå­˜å‚¨åˆ°æ–‡ä»¶
- é€šè¿‡ç½‘ç»œä¼ è¾“å¯¹è±¡
- å®ç°å¯¹è±¡çš„æ·±åº¦å…‹éš†

### ğŸ’» ä»£ç ç¤ºä¾‹

**å®šä¹‰å¯åºåˆ—åŒ–çš„ç±»**:

```java
import java.io.*;

class Goods implements Serializable {
    String name = null;
    double unitPrice;
    
    Goods(String name, double unitPrice) {
        this.name = name;
        this.unitPrice = unitPrice;
    }
    
    public void setUnitPrice(double unitPrice) {
        this.unitPrice = unitPrice;
    }
    
    public double getUnitPrice() {
        return unitPrice;
    }
    
    public void setName(String name) {
        this.name = name;
    }
    
    public String getName() {
        return name;
    }
}
```

**ä½¿ç”¨å¯¹è±¡æµ**:

```java
public class Example9_9 {
    public static void main(String args[]) {
        Goods TV1 = new Goods("HaierTV", 3468);
        
        try {
            // å†™å…¥å¯¹è±¡
            FileOutputStream fileOut = new FileOutputStream("a.txt");
            ObjectOutputStream objectOut = new ObjectOutputStream(fileOut);
            objectOut.writeObject(TV1);
            objectOut.close();
            
            // è¯»å–å¯¹è±¡
            FileInputStream fileIn = new FileInputStream("a.txt");
            ObjectInputStream objectIn = new ObjectInputStream(fileIn);
            Goods TV2 = (Goods) objectIn.readObject();  // éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢
            objectIn.close();
            
            // ä¿®æ”¹TV2ï¼Œä¸å½±å“TV1
            TV2.setUnitPrice(8888);
            TV2.setName("GreatWall");
            
            System.out.printf("\nTV1: %s, %f", TV1.getName(), TV1.getUnitPrice());
            System.out.printf("\nTV2: %s, %f", TV2.getName(), TV2.getUnitPrice());
        } catch (Exception event) {
            System.out.println(event);
        }
    }
}
```

**è¾“å‡ºç»“æœ**:
```
TV1: HaierTV, 3468.000000
TV2: GreatWall, 8888.000000
```

---

## ğŸ” 9.10 åºåˆ—åŒ–å’Œå¯¹è±¡å…‹éš†

### ğŸ·ï¸ æ·±åº¦å…‹éš†åŸç†

**ä½¿ç”¨å¯¹è±¡æµå®ç°æ·±åº¦å…‹éš†**:
1. å°†åŸå¯¹è±¡å†™å…¥å¯¹è±¡è¾“å‡ºæµ
2. ç”¨å¯¹è±¡è¾“å…¥æµè¯»å›å¯¹è±¡
3. è¯»å›çš„å¯¹è±¡å°±æ˜¯åŸå¯¹è±¡çš„æ·±åº¦å…‹éš†

**æ·±åº¦å…‹éš† vs æµ…åº¦å…‹éš†**:

| å…‹éš†ç±»å‹ | å¼•ç”¨å‹å˜é‡ | ä¿®æ”¹å…‹éš†å¯¹è±¡ | åŸå¯¹è±¡å—å½±å“ |
|---------|-----------|-------------|-------------|
| æµ…åº¦å…‹éš† | å¤åˆ¶å¼•ç”¨ | ä¿®æ”¹å¼•ç”¨å¯¹è±¡ | âœ… å—å½±å“ |
| æ·±åº¦å…‹éš† | å¤åˆ¶å¯¹è±¡ | ä¿®æ”¹å¼•ç”¨å¯¹è±¡ | âŒ ä¸å—å½±å“ |

### ğŸ’» ä»£ç ç¤ºä¾‹

**å®šä¹‰å¯åºåˆ—åŒ–çš„ç±»**:

```java
import java.io.*;

class Goods implements Serializable {
    String name = null;
    
    Goods(String name) {
        this.name = name;
    }
    
    public void setName(String name) {
        this.name = name;
    }
    
    public String getName() {
        return name;
    }
}

class Shop implements Serializable {
    Goods goods[];
    
    public void setGoods(Goods[] s) {
        goods = s;
    }
    
    public Goods[] getGoods() {
        return goods;
    }
}
```

**æ·±åº¦å…‹éš†å®ç°**:

```java
public class Example9_10 {
    public static void main(String args[]) {
        Shop shop1 = new Shop();
        Goods s1[] = {new Goods("TV"), new Goods("PC")};
        shop1.setGoods(s1);
        
        try {
            // ä½¿ç”¨ByteArrayOutputStreamä½œä¸ºä¸´æ—¶å­˜å‚¨
            ByteArrayOutputStream out = new ByteArrayOutputStream();
            ObjectOutputStream objectOut = new ObjectOutputStream(out);
            objectOut.writeObject(shop1);
            
            // ä»å­—èŠ‚æ•°ç»„è¯»å–å¯¹è±¡
            ByteArrayInputStream in = new ByteArrayInputStream(out.toByteArray());
            ObjectInputStream objectIn = new ObjectInputStream(in);
            Shop shop2 = (Shop) objectIn.readObject();
            
            // éªŒè¯æ·±åº¦å…‹éš†
            Goods goods2[] = shop2.getGoods();
            System.out.println("shop2:");
            for (int i = 0; i < goods2.length; i++) {
                System.out.println(goods2[i].getName());
            }
        } catch (Exception event) {
            System.out.println(event);
        }
    }
}
```

> ğŸ’¡ **å…³é”®æ–¹æ³•**: `out.toByteArray()` - è¿”å›è¾“å‡ºæµå†™å…¥åˆ°ç¼“å†²åŒºçš„å…¨éƒ¨å­—èŠ‚

---

## ğŸ” 9.6 æ•°ç»„æµ

### ğŸ·ï¸ å­—èŠ‚æ•°ç»„æµ

**æ ¸å¿ƒç‰¹ç‚¹**:
- ä½¿ç”¨**å­—èŠ‚æ•°ç»„**ä½œä¸ºæµçš„æºå’Œç›®çš„åœ°
- åœ¨å†…å­˜ä¸­è¿›è¡ŒI/Oæ“ä½œ

**ç±»å‹**:

| ç±» | ç±»å‹ | åŠŸèƒ½ |
|----|------|------|
| `ByteArrayInputStream` | å­—èŠ‚è¾“å…¥æµ | ä»å­—èŠ‚æ•°ç»„è¯»å–æ•°æ® |
| `ByteArrayOutputStream` | å­—èŠ‚è¾“å‡ºæµ | å‘å­—èŠ‚æ•°ç»„å†™å…¥æ•°æ® |

### ğŸ› ï¸ æ„é€ æ–¹æ³•

**ByteArrayInputStream**:

```java
// æ–¹å¼1: ä½¿ç”¨æ•´ä¸ªæ•°ç»„ä½œä¸ºæº
byte[] buf = {65, 66, 67};
ByteArrayInputStream input = new ByteArrayInputStream(buf);

// æ–¹å¼2: ä½¿ç”¨æ•°ç»„çš„ä¸€éƒ¨åˆ†ä½œä¸ºæº
ByteArrayInputStream input = new ByteArrayInputStream(buf, offset, length);
```

**ByteArrayOutputStream**:

```java
// æ–¹å¼1: é»˜è®¤ç¼“å†²åŒºå¤§å°32å­—èŠ‚
ByteArrayOutputStream output = new ByteArrayOutputStream();

// æ–¹å¼2: æŒ‡å®šç¼“å†²åŒºåˆå§‹å¤§å°
ByteArrayOutputStream output = new ByteArrayOutputStream(size);
```

> ğŸ’¡ **è‡ªåŠ¨æ‰©å®¹**: å¦‚æœå†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡ç¼“å†²åŒºå¤§å°ï¼Œç¼“å†²åŒºä¼šè‡ªåŠ¨å¢åŠ 

### ğŸ“Œ é‡è¦æ–¹æ³•

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `byte[] toByteArray()` | è¿”å›è¾“å‡ºæµå†™å…¥ç¼“å†²åŒºçš„å…¨éƒ¨å­—èŠ‚ |

### ğŸ’» ä»£ç ç¤ºä¾‹

```java
import java.io.*;

public class Example9_6 {
    public static void main(String args[]) {
        int n = -1;
        
        // åˆ›å»ºå­—èŠ‚æ•°ç»„è¾“å‡ºæµ
        ByteArrayOutputStream output = new ByteArrayOutputStream();
        
        // å†™å…¥ASCIIå­—ç¬¦ A-E
        for (int i = 0; i < 5; i++) {
            output.write('A' + i);
        }
        
        // ä»è¾“å‡ºæµçš„ç¼“å†²åŒºåˆ›å»ºè¾“å…¥æµ
        ByteArrayInputStream input = new ByteArrayInputStream(output.toByteArray());
        
        // è¯»å–å¹¶æ˜¾ç¤º
        while ((n = input.read()) != -1) {
            System.out.println(n + ": " + (char) n);
        }
    }
}
```

**è¾“å‡ºç»“æœ**:
```
65: A
66: B
67: C
68: D
69: E
```

### ğŸ·ï¸ å­—ç¬¦æ•°ç»„æµ

**æ ¸å¿ƒç‰¹ç‚¹**:
- ä½¿ç”¨**å­—ç¬¦æ•°ç»„**ä½œä¸ºæµçš„æºå’Œç›®çš„åœ°
- è¯»æ“ä½œå¯èƒ½å‘ç”Ÿ`IOException`å¼‚å¸¸ï¼Œéœ€è¦try-catchè¯­å¥

**ç±»å‹**:

| ç±» | ç±»å‹ | åŠŸèƒ½ |
|----|------|------|
| `CharArrayReader` | å­—ç¬¦è¾“å…¥æµ | ä»å­—ç¬¦æ•°ç»„è¯»å–æ•°æ® |
| `CharArrayWriter` | å­—ç¬¦è¾“å‡ºæµ | å‘å­—ç¬¦æ•°ç»„å†™å…¥æ•°æ® |

### ğŸ’» ä»£ç ç¤ºä¾‹

```java
import java.io.*;

public class Example9_7 {
    public static void main(String args[]) {
        int n = -1;
        
        // åˆ›å»ºå­—ç¬¦æ•°ç»„è¾“å‡ºæµ
        CharArrayWriter output = new CharArrayWriter();
        
        // å†™å…¥Unicodeå­—ç¬¦
        for (int i = 65; i <= 69; i++) {
            output.write(i);
        }
        
        // ä»è¾“å‡ºæµçš„ç¼“å†²åŒºåˆ›å»ºè¾“å…¥æµ
        CharArrayReader input = new CharArrayReader(output.toCharArray());
        
        try {
            // è¯»å–å¹¶æ˜¾ç¤º
            while ((n = input.read()) != -1) {
                System.out.println(n + ": " + (char) n);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

> ğŸ’¡ **å…³é”®æ–¹æ³•**: `output.toCharArray()` - è¿”å›è¾“å‡ºæµå†™å…¥ç¼“å†²åŒºçš„å…¨éƒ¨å­—ç¬¦

---

## ğŸ” 9.7 å­—ç¬¦ä¸²æµ

### ğŸ·ï¸ StringReaderç±»

**æ ¸å¿ƒç‰¹ç‚¹**:
- ä½¿ç”¨**å­—ç¬¦ä¸²**ä½œä¸ºæµçš„æº
- ä¸éœ€è¦æŒ‡å‘å®é™…æ–‡ä»¶

**æ„é€ æ–¹æ³•**:

```java
String s = "Hello World";
StringReader reader = new StringReader(s);
```

**å¸¸ç”¨æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ | è¿”å›ç±»å‹ |
|------|------|---------|
| `int read()` | è¯»å–ä¸€ä¸ªå­—ç¬¦ | Unicodeä½ç½®ï¼Œæœ«å°¾è¿”å›-1 |
| `int read(char[] buf, int off, int len)` | è¯»å–lenä¸ªå­—ç¬¦åˆ°æ•°ç»„buf | å®é™…è¯»å–çš„å­—ç¬¦æ•° |

### ğŸ·ï¸ StringWriterç±»

**æ ¸å¿ƒç‰¹ç‚¹**:
- å°†**å†…å­˜**ä½œä¸ºæµçš„ç›®çš„åœ°
- æ•°æ®å†™å…¥ç¼“å†²åŒº

**æ„é€ æ–¹æ³•**:

```java
// æ–¹å¼1: é»˜è®¤ç¼“å†²åŒº
StringWriter writer = new StringWriter();

// æ–¹å¼2: æŒ‡å®šåˆå§‹å¤§å°
StringWriter writer = new StringWriter(size);
```

**å¸¸ç”¨æ–¹æ³•**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `void write(int b)` | å†™å…¥ä¸€ä¸ªå­—ç¬¦ |
| `void write(char[] buf, int off, int len)` | å†™å…¥å­—ç¬¦æ•°ç»„çš„ä¸€éƒ¨åˆ† |
| `void write(String str)` | å†™å…¥æ•´ä¸ªå­—ç¬¦ä¸² |
| `void write(String str, int off, int len)` | å†™å…¥å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ† |
| `String toString()` | è¿”å›ç¼“å†²åŒºçš„å…¨éƒ¨å­—ç¬¦ |

### ğŸ’» ä»£ç ç¤ºä¾‹

```java
import java.io.*;

public class StringStreamDemo {
    public static void main(String args[]) {
        // StringWriterç¤ºä¾‹
        StringWriter writer = new StringWriter();
        writer.write("Hello ");
        writer.write("World!");
        String result = writer.toString();
        System.out.println(result);  // è¾“å‡º: Hello World!
        
        // StringReaderç¤ºä¾‹
        StringReader reader = new StringReader(result);
        try {
            int c;
            while ((c = reader.read()) != -1) {
                System.out.print((char) c);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

---

## ğŸ” 9.11 éšæœºè¯»å†™æµ

### ğŸ·ï¸ RandomAccessFileç±»

**æ ¸å¿ƒç‰¹ç‚¹**:
- å¯ä»¥åœ¨æ–‡ä»¶çš„**ä»»æ„ä½ç½®**è¯»å†™æ•°æ®
- æ—¢å¯ä»¥è¯»ä¹Ÿå¯ä»¥å†™ï¼ˆå‰é¢çš„æµéƒ½æ˜¯åªè¯»æˆ–åªå†™ï¼‰
- ä½¿ç”¨**æ–‡ä»¶æŒ‡é’ˆ** (file pointer) å®šä½è¯»å†™ä½ç½®

**æ–‡ä»¶æŒ‡é’ˆæœºåˆ¶**:

```mermaid
graph LR
    A[æ–‡ä»¶å¼€å§‹] --> B[æ–‡ä»¶æŒ‡é’ˆ]
    B --> C[è¯»/å†™æ“ä½œ]
    C --> D[æŒ‡é’ˆè‡ªåŠ¨å‰ç§»]
    D --> E[ä¸‹ä¸€ä¸ªæ•°æ®é¡¹]
```

### ğŸ› ï¸ æ„é€ æ–¹æ³•

```java
// æ–¹å¼1: é€šè¿‡æ–‡ä»¶ååˆ›å»º
RandomAccessFile file = new RandomAccessFile("tom.dat", "rw");

// æ–¹å¼2: é€šè¿‡Fileå¯¹è±¡åˆ›å»º
File f = new File("tom.dat");
RandomAccessFile file = new RandomAccessFile(f, "r");
```

**è®¿é—®æ¨¡å¼**:

| æ¨¡å¼ | è¯´æ˜ | ä½¿ç”¨å»ºè®® |
|------|------|---------|
| `"r"` | åªè¯»æ¨¡å¼ | æ–‡ä»¶ä¸éœ€è¦ä¿®æ”¹æ—¶ä½¿ç”¨ï¼Œé˜²æ­¢æ„å¤–ä¿®æ”¹ |
| `"rw"` | è¯»å†™æ¨¡å¼ | éœ€è¦ä¿®æ”¹æ–‡ä»¶æ—¶ä½¿ç”¨ |

> âš ï¸ **æœ€ä½³å®è·µ**: å¦‚æœæ–‡ä»¶ä¸æ‰“ç®—ä¿®æ”¹ï¼Œä½¿ç”¨"r"æ¨¡å¼æ‰“å¼€ï¼Œé˜²æ­¢æ„å¤–ä¿®æ”¹

### ğŸ“Š å¸¸ç”¨æ–¹æ³•

**æ–‡ä»¶æŒ‡é’ˆæ“ä½œ**:

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `long getFilePointer()` | è·å–å½“å‰æ–‡ä»¶æŒ‡é’ˆä½ç½® |
| `void seek(long pos)` | å°†æ–‡ä»¶æŒ‡é’ˆç§»åŠ¨åˆ°æŒ‡å®šä½ç½® |
| `long length()` | è·å–æ–‡ä»¶é•¿åº¦ |

**è¯»å†™æ–¹æ³•**:

| æ–¹æ³•                          | åŠŸèƒ½     |
| --------------------------- | ------ |
| `int readInt()`             | è¯»å–intå€¼ |
| `void writeInt(int v)`      | å†™å…¥intå€¼ |
| `String readLine()`         | è¯»å–ä¸€è¡Œæ–‡æœ¬ |
| `void writeBytes(String s)` | å†™å…¥å­—ç¬¦ä¸²  |

### ğŸ’» ç¤ºä¾‹1: åå‘è¯»å–æ•´æ•°

```java
import java.io.*;

public class Example9_11 {
    public static void main(String args[]) {
        RandomAccessFile inAndOut = null;
        int[] data = {20, 30, 40, 50, 60};
        
        try {
            inAndOut = new RandomAccessFile("a.dat", "rw");
            
            // å†™å…¥æ•´æ•°
            for (int i = 0; i < data.length; i++) {
                inAndOut.writeInt(data[i]);
            }
            
            // åå‘è¯»å–ï¼ˆæ¯ä¸ªintå 4å­—èŠ‚ï¼‰
            for (long i = data.length - 1; i >= 0; i--) {
                inAndOut.seek(i * 4);  // ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆ
                System.out.println(inAndOut.readInt());
            }
            
            inAndOut.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

**è¾“å‡ºç»“æœ**:
```
60
50
40
30
20
```

### ğŸ’» ç¤ºä¾‹2: ä½¿ç”¨readLine()è¯»å–æ–‡æœ¬

```java
import java.io.*;

public class Example9_12 {
    public static void main(String args[]) {
        RandomAccessFile input = null;
        
        try {
            input = new RandomAccessFile("test.txt", "rw");
            long length = input.length();  // è·å–æ–‡ä»¶é•¿åº¦
            long position = 0;
            
            input.seek(position);  // ç§»åŠ¨åˆ°æ–‡ä»¶å¼€å§‹
            
            while (position < length) {
                String str = input.readLine();
                position = input.getFilePointer();  // è·å–å½“å‰æŒ‡é’ˆä½ç½®
                System.out.println(str);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

---

## ğŸ” 9.13 æ–‡ä»¶é”

### ğŸ·ï¸ FileLockç±»

**æ ¸å¿ƒç‰¹ç‚¹**:
- JDK 1.4å¼•å…¥
- å¯¹æ–‡ä»¶åŠ é”åï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•æ“ä½œè¢«é”å®šçš„æ–‡ä»¶
- åªæœ‰è§£é™¤é”æ‰èƒ½ç»§ç»­æ“ä½œ

### ğŸ” ä½¿ç”¨æ­¥éª¤

**Step 1: åˆ›å»ºRandomAccessFileæµ**:

```java
RandomAccessFile input = new RandomAccessFile("Example.java", "rw");
```

> âš ï¸ **æ³¨æ„**: è¯»å†™å±æ€§å¿…é¡»æ˜¯`"rw"`

**Step 2: è·å–æ–‡ä»¶ä¿¡é“ (FileChannel)**:

```java
FileChannel channel = input.getChannel();
```

**Step 3: è·å–æ–‡ä»¶é”**:

```java
FileLock lock = channel.tryLock();  // æˆ–ä½¿ç”¨lock()æ–¹æ³•
```

**é”æ–¹æ³•å¯¹æ¯”**:

| æ–¹æ³• | é˜»å¡è¡Œä¸º | è¿”å›å€¼ |
|------|---------|--------|
| `tryLock()` | éé˜»å¡ï¼Œç«‹å³è¿”å› | æˆåŠŸè¿”å›FileLockï¼Œå¤±è´¥è¿”å›null |
| `lock()` | é˜»å¡ï¼Œç›´åˆ°è·å–é” | è¿”å›FileLock |

### ğŸ“Œ å…¶ä»–æµä¹Ÿå¯ä½¿ç”¨æ–‡ä»¶é”

```java
// FileInputStreamä¹Ÿå¯ä»¥è·å–æ–‡ä»¶é”
FileInputStream fis = new FileInputStream("file.txt");
FileChannel channel = fis.getChannel();
FileLock lock = channel.tryLock(0, Long.MAX_VALUE, true);  // å…±äº«é”
```

### ğŸ’» ä»£ç ç¤ºä¾‹

```java
import java.io.*;
import java.nio.channels.*;

public class Example9_13 {
    public static void main(String args[]) {
        int b;
        byte tom[] = new byte[12];
        
        try {
            RandomAccessFile input = new RandomAccessFile("test.txt", "rw");
            FileChannel channel = input.getChannel();
            
            while ((b = input.read(tom, 0, 10)) != -1) {
                // è·å–æ–‡ä»¶é”
                FileLock lock = channel.tryLock();
                
                String s = new String(tom, 0, b);
                System.out.print(s);
                
                try {
                    Thread.sleep(1000);  // æ¨¡æ‹Ÿå¤„ç†æ—¶é—´
                    lock.release();      // é‡Šæ”¾é”
                } catch (Exception e) {
                    System.out.println(e);
                }
            }
            
            input.close();
        } catch (Exception e) {
            System.out.println(e);
        }
    }
}
```

> ğŸ’¡ **åº”ç”¨åœºæ™¯**: åœ¨Javaç¨‹åºè¯»å–æ–‡ä»¶æ—¶ä½¿ç”¨æ–‡ä»¶é”ï¼Œå…¶ä»–ç¨‹åºï¼ˆå¦‚è®°äº‹æœ¬ï¼‰æ— æ³•ä¿®æ”¹ã€ä¿å­˜è¯¥æ–‡ä»¶

---

## ğŸ—‚ï¸ Java I/Oç±»ä½“ç³»æ€»ç»“

### ğŸ“Š I/Oç±»å±‚æ¬¡ç»“æ„

```mermaid
graph TD
    A[java.io] --> B[å­—èŠ‚æµ]
    A --> C[å­—ç¬¦æµ]
    
    B --> D[InputStream]
    B --> E[OutputStream]
    
    C --> F[Reader]
    C --> G[Writer]
    
    D --> H[FileInputStream]
    D --> I[ByteArrayInputStream]
    D --> J[DataInputStream]
    D --> K[ObjectInputStream]
    
    E --> L[FileOutputStream]
    E --> M[ByteArrayOutputStream]
    E --> N[DataOutputStream]
    E --> O[ObjectOutputStream]
    
    F --> P[FileReader]
    F --> Q[CharArrayReader]
    F --> R[StringReader]
    F --> S[BufferedReader]
    
    G --> T[FileWriter]
    G --> U[CharArrayWriter]
    G --> V[StringWriter]
    G --> W[BufferedWriter]
```

### ğŸ“Œ æµçš„åˆ†ç±»

#### æŒ‰åŠŸèƒ½åˆ†ç±»

| ç±»åˆ« | å­—èŠ‚æµ | å­—ç¬¦æµ |
|------|--------|--------|
| **æ–‡ä»¶æµ** | FileInputStream<br/>FileOutputStream | FileReader<br/>FileWriter |
| **ç¼“å†²æµ** | BufferedInputStream<br/>BufferedOutputStream | BufferedReader<br/>BufferedWriter |
| **æ•°ç»„æµ** | ByteArrayInputStream<br/>ByteArrayOutputStream | CharArrayReader<br/>CharArrayWriter |
| **å­—ç¬¦ä¸²æµ** | - | StringReader<br/>StringWriter |
| **æ•°æ®æµ** | DataInputStream<br/>DataOutputStream | - |
| **å¯¹è±¡æµ** | ObjectInputStream<br/>ObjectOutputStream | - |

#### å…¶ä»–é‡è¦ç±»

| ç±» | åŠŸèƒ½ | ç‰¹ç‚¹ |
|----|------|------|
| `File` | æ–‡ä»¶å±æ€§æ“ä½œ | ä¸æ¶‰åŠè¯»å†™ |
| `Scanner` | æ–‡æœ¬è§£æ | æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ |
| `RandomAccessFile` | éšæœºè¯»å†™ | å®ç°DataInputå’ŒDataOutputæ¥å£ |
| `FileLock` | æ–‡ä»¶é” | é€šè¿‡FileChannelè·å– |
| `Serializable` | åºåˆ—åŒ–æ¥å£ | æ ‡è®°æ¥å£ï¼Œæ— éœ€å®ç°æ–¹æ³• |

### ğŸ”„ æµçš„åŒ…è£…ï¼ˆè£…é¥°å™¨æ¨¡å¼ï¼‰

**åŒ…è£…ç¤ºä¾‹**:

```java
// ç¼“å†²å­—èŠ‚è¾“å…¥æµåŒ…è£…
BufferedInputStream input = new BufferedInputStream(
    new FileInputStream("input.dat")
);

// æ•°æ®è¾“å…¥æµåŒ…è£…
DataInputStream input = new DataInputStream(
    new FileInputStream("input.dat")
);

// å¯¹è±¡è¾“å…¥æµåŒ…è£…
ObjectInputStream input = new ObjectInputStream(
    new FileInputStream("input.dat")
);

// åŒé‡åŒ…è£…ï¼šå¯¹è±¡æµ + ç¼“å†²æµ
ObjectInputStream input = new ObjectInputStream(
    new BufferedInputStream(
        new FileInputStream("input.dat")
    )
);
```

> ğŸ’¡ **è£…é¥°å™¨æ¨¡å¼ä¼˜åŠ¿**: 
> - å¢å¼ºæµçš„åŠŸèƒ½ï¼ˆå¦‚æ·»åŠ ç¼“å†²ï¼‰
> - çµæ´»ç»„åˆä¸åŒåŠŸèƒ½
> - æé«˜I/Oæ•ˆç‡

---

## ğŸ† è¡¥å……çŸ¥è¯†

### ğŸ“Š æ–‡æœ¬I/O vs äºŒè¿›åˆ¶I/O

**æ ¸å¿ƒåŒºåˆ«**:

| ç‰¹æ€§ | æ–‡æœ¬I/O | äºŒè¿›åˆ¶I/O |
|------|---------|-----------|
| æ•°æ®è¡¨ç¤º | äººç±»å¯è¯»å½¢å¼ | äºŒè¿›åˆ¶å½¢å¼ |
| ç¼–ç /è§£ç  | éœ€è¦ | ä¸éœ€è¦ |
| å¤„ç†æ•ˆç‡ | è¾ƒä½ | è¾ƒé«˜ |
| é€‚ç”¨åœºæ™¯ | æ–‡æœ¬ç¼–è¾‘å™¨åˆ›å»ºçš„æ–‡ä»¶ | Javaç¨‹åºåˆ›å»ºçš„æ•°æ®æ–‡ä»¶ |
| æ¨èç±» | Reader/Writerã€Scanner/PrintWriter | InputStream/OutputStream |

### ğŸ—ï¸ æµçš„æ•ˆç‡ä¼˜åŒ–

**ä½¿ç”¨ç¼“å†²æµæé€Ÿ**:

```java
// ä¸æ¨èï¼šç›´æ¥ä½¿ç”¨FileInputStreamï¼ˆæ…¢ï¼‰
FileInputStream fis = new FileInputStream("large.dat");

// æ¨èï¼šä½¿ç”¨BufferedInputStreamï¼ˆå¿«ï¼‰
BufferedInputStream bis = new BufferedInputStream(
    new FileInputStream("large.dat")
);
```

> ğŸ’¡ **æœ€ä½³å®è·µ**: å§‹ç»ˆä½¿ç”¨ç¼“å†²I/Oæ¥æé«˜è¾“å…¥è¾“å‡ºé€Ÿåº¦

### ğŸ”„ DataInputStream vs ObjectInputStream

**åŠŸèƒ½å¯¹æ¯”**:

| ç‰¹æ€§ | DataInputStream | ObjectInputStream |
|------|----------------|-------------------|
| è¯»å–åŸºæœ¬ç±»å‹ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |
| è¯»å–å­—ç¬¦ä¸² | âœ… æ”¯æŒ | âœ… æ”¯æŒ |
| è¯»å–å¯¹è±¡ | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| å¤„ç†æ•ˆç‡ | é«˜ | ç›¸å¯¹è¾ƒä½ |
| é€‚ç”¨åœºæ™¯ | åŸºæœ¬æ•°æ®ç±»å‹ | éœ€è¦åºåˆ—åŒ–å¯¹è±¡ |

> ğŸ’¡ **è¯´æ˜**: ObjectInputStreamå¯ä»¥å®Œå…¨æ›¿ä»£DataInputStreamï¼Œä½†æ•ˆç‡ä¼šä½ä¸€äº›

### ğŸ“Œ åºåˆ—åŒ– (Serializable)

**å®šä¹‰**:
- èƒ½å¤Ÿè¢«å†™å…¥è¾“å‡ºæµçš„å¯¹è±¡ç§°ä¸º**åºåˆ—åŒ–å¯¹è±¡** (serializable object)
- å¿…é¡»å®ç°`java.io.Serializable`æ¥å£

**ç‰¹ç‚¹**:
- Serializableæ˜¯**æ ‡è®°æ¥å£**ï¼ˆæ— æ–¹æ³•ï¼‰
- æ— éœ€å®ç°ä»»ä½•æ–¹æ³•
- JVMè‡ªåŠ¨å¤„ç†åºåˆ—åŒ–è¿‡ç¨‹

```java
class Student implements Serializable {
    // æ— éœ€å®ç°ä»»ä½•æ–¹æ³•
}
```

### ğŸ” RandomAccessFileçš„æ¥å£

**å®ç°çš„æ¥å£**:
- `DataInput`: æä¾›è¯»å–åŸºæœ¬ç±»å‹çš„æ–¹æ³•
- `DataOutput`: æä¾›å†™å…¥åŸºæœ¬ç±»å‹çš„æ–¹æ³•

**ç‰¹ç‚¹**:
- æ‰€æœ‰è¯»å†™æµéƒ½æ˜¯**åªè¯»**æˆ–**åªå†™**
- RandomAccessFileæ˜¯å”¯ä¸€å¯ä»¥**éšæœºä½ç½®è¯»å†™**çš„ç±»

---

## Try-with-resources (è‡ªåŠ¨èµ„æºç®¡ç†)

### ğŸ·ï¸ ä¼ ç»Ÿèµ„æºç®¡ç†çš„é—®é¢˜

**ä¼ ç»Ÿæ–¹å¼çš„ç¼ºç‚¹**:

```java
// ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦æ‰‹åŠ¨å…³é—­æµ
FileInputStream fis = null;
try {
    fis = new FileInputStream("file.txt");
    // è¯»å–æ“ä½œ
} catch (IOException e) {
    e.printStackTrace();
} finally {
    // å¿…é¡»æ‰‹åŠ¨å…³é—­ï¼Œå®¹æ˜“é—å¿˜
    if (fis != null) {
        try {
            fis.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

**é—®é¢˜**:
- ä»£ç å†—é•¿ï¼Œéœ€è¦åœ¨finallyå—ä¸­æ‰‹åŠ¨å…³é—­
- å®¹æ˜“å¿˜è®°å…³é—­èµ„æºï¼Œé€ æˆèµ„æºæ³„æ¼
- åµŒå¥—çš„try-catchä½¿ä»£ç éš¾ä»¥é˜…è¯»

### ğŸš€ Try-with-resourcesè¯­æ³• (JDK 7+)

**åŸºæœ¬è¯­æ³•**:

```java
try (èµ„æºå£°æ˜1; èµ„æºå£°æ˜2; ...) {
    // ä½¿ç”¨èµ„æº
} catch (Exception e) {
    // å¼‚å¸¸å¤„ç†
}
// èµ„æºä¼šè‡ªåŠ¨å…³é—­
```

**ç¤ºä¾‹1: å•ä¸ªèµ„æº**:

```java
try (FileInputStream fis = new FileInputStream("input.txt")) {
    int data = fis.read();
    while (data != -1) {
        System.out.print((char) data);
        data = fis.read();
    }
} catch (IOException e) {
    e.printStackTrace();
}
// fisä¼šè‡ªåŠ¨å…³é—­
```

**ç¤ºä¾‹2: å¤šä¸ªèµ„æº**:

```java
try (FileReader reader = new FileReader("input.txt");
     BufferedReader br = new BufferedReader(reader)) {
    String line;
    while ((line = br.readLine()) != null) {
        System.out.println(line);
    }
} catch (IOException e) {
    e.printStackTrace();
}
// readerå’Œbréƒ½ä¼šè‡ªåŠ¨å…³é—­
```

**ç¤ºä¾‹3: æ–‡ä»¶å¤åˆ¶**:

```java
public static void copyFile(String source, String dest) {
    try (FileInputStream fis = new FileInputStream(source);
         FileOutputStream fos = new FileOutputStream(dest)) {
        
        byte[] buffer = new byte[1024];
        int length;
        while ((length = fis.read(buffer)) > 0) {
            fos.write(buffer, 0, length);
        }
        System.out.println("æ–‡ä»¶å¤åˆ¶æˆåŠŸ!");
    } catch (IOException e) {
        System.out.println("æ–‡ä»¶å¤åˆ¶å¤±è´¥: " + e.getMessage());
    }
}
```

### ğŸ“Œ AutoCloseableæ¥å£

**è¦æ±‚**:
- try-with-resourcesåªèƒ½ç”¨äºå®ç°äº†`AutoCloseable`æˆ–`Closeable`æ¥å£çš„ç±»
- æ‰€æœ‰I/Oæµéƒ½å®ç°äº†è¿™äº›æ¥å£

**è‡ªå®šä¹‰AutoCloseableèµ„æº**:

```java
class MyResource implements AutoCloseable {
    public MyResource() {
        System.out.println("èµ„æºå·²æ‰“å¼€");
    }
    
    public void doSomething() {
        System.out.println("æ­£åœ¨ä½¿ç”¨èµ„æº");
    }
    
    @Override
    public void close() {
        System.out.println("èµ„æºå·²å…³é—­");
    }
}

// ä½¿ç”¨
try (MyResource resource = new MyResource()) {
    resource.doSomething();
}
// è¾“å‡º:
// èµ„æºå·²æ‰“å¼€
// æ­£åœ¨ä½¿ç”¨èµ„æº
// èµ„æºå·²å…³é—­
```

> ğŸ’¡ **æœ€ä½³å®è·µ**: åœ¨Java 7åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œå§‹ç»ˆä½¿ç”¨try-with-resourcesæ¥ç®¡ç†I/Oèµ„æº

---

## ğŸ› ï¸ å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### âŒ é”™è¯¯1: FileNotFoundException

**åŸå› **:
- æ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®
- æ–‡ä»¶ä¸å­˜åœ¨
- æ²¡æœ‰è¯»å–æƒé™

**è§£å†³æ–¹æ¡ˆ**:

```java
File file = new File("test.txt");
if (!file.exists()) {
    System.out.println("æ–‡ä»¶ä¸å­˜åœ¨: " + file.getAbsolutePath());
    // åˆ›å»ºæ–‡ä»¶
    file.createNewFile();
}

try (FileReader fr = new FileReader(file)) {
    // è¯»å–æ“ä½œ
} catch (FileNotFoundException e) {
    System.out.println("æ‰¾ä¸åˆ°æ–‡ä»¶: " + e.getMessage());
} catch (IOException e) {
    System.out.println("è¯»å–é”™è¯¯: " + e.getMessage());
}
```

### âŒ é”™è¯¯2: ä¸­æ–‡ä¹±ç é—®é¢˜

**åŸå› **: å­—ç¬¦ç¼–ç ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**:

```java
// æ–¹å¼1: ä½¿ç”¨InputStreamReaderæŒ‡å®šç¼–ç 
try (FileInputStream fis = new FileInputStream("test.txt");
     InputStreamReader isr = new InputStreamReader(fis, "UTF-8");
     BufferedReader br = new BufferedReader(isr)) {
    String line;
    while ((line = br.readLine()) != null) {
        System.out.println(line);
    }
}

// æ–¹å¼2: ä½¿ç”¨OutputStreamWriteræŒ‡å®šç¼–ç 
try (FileOutputStream fos = new FileOutputStream("output.txt");
     OutputStreamWriter osw = new OutputStreamWriter(fos, "UTF-8");
     BufferedWriter bw = new BufferedWriter(osw)) {
    bw.write("ä¸­æ–‡å†…å®¹");
}

// æ–¹å¼3: ä½¿ç”¨Filesç±» (æ¨èï¼ŒJDK 7+)
import java.nio.file.*;
import java.nio.charset.*;

// è¯»å–
List<String> lines = Files.readAllLines(
    Paths.get("test.txt"), 
    StandardCharsets.UTF_8
);

// å†™å…¥
Files.write(
    Paths.get("output.txt"), 
    lines, 
    StandardCharsets.UTF_8
);
```

### âŒ é”™è¯¯3: å¿˜è®°å…³é—­æµå¯¼è‡´èµ„æºæ³„æ¼

**é—®é¢˜ä»£ç **:

```java
// âŒ é”™è¯¯ï¼šæ²¡æœ‰å…³é—­æµ
FileWriter fw = new FileWriter("test.txt");
fw.write("Hello");
// å¿˜è®°è°ƒç”¨fw.close()
```

**è§£å†³æ–¹æ¡ˆ**:

```java
// âœ… æ­£ç¡®ï¼šä½¿ç”¨try-with-resources
try (FileWriter fw = new FileWriter("test.txt")) {
    fw.write("Hello");
} // è‡ªåŠ¨å…³é—­
```

### âŒ é”™è¯¯4: è¯»å–æ—¶æ²¡æœ‰æ£€æŸ¥è¿”å›å€¼

**é—®é¢˜ä»£ç **:

```java
// âŒ é”™è¯¯ï¼šå‡è®¾æ€»èƒ½è¯»å–å›ºå®šå­—èŠ‚æ•°
byte[] buffer = new byte[100];
fis.read(buffer);  // å¯èƒ½åªè¯»å–äº†éƒ¨åˆ†æ•°æ®
```

**è§£å†³æ–¹æ¡ˆ**:

```java
// âœ… æ­£ç¡®ï¼šæ£€æŸ¥å®é™…è¯»å–çš„å­—èŠ‚æ•°
byte[] buffer = new byte[100];
int bytesRead = fis.read(buffer);
if (bytesRead != -1) {
    // å¤„ç†å®é™…è¯»å–çš„bytesReadä¸ªå­—èŠ‚
    String data = new String(buffer, 0, bytesRead);
}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§

### 1ï¸âƒ£ ä½¿ç”¨ç¼“å†²æµ

**æ€§èƒ½å¯¹æ¯”**:

```java
// âŒ æ…¢ï¼šç›´æ¥ä½¿ç”¨FileInputStream
long start = System.currentTimeMillis();
try (FileInputStream fis = new FileInputStream("large.txt")) {
    while (fis.read() != -1) {
        // æ¯æ¬¡è¯»å–1ä¸ªå­—èŠ‚ï¼Œç³»ç»Ÿè°ƒç”¨æ¬¡æ•°å¤š
    }
}
long time1 = System.currentTimeMillis() - start;

// âœ… å¿«ï¼šä½¿ç”¨BufferedInputStream
start = System.currentTimeMillis();
try (BufferedInputStream bis = new BufferedInputStream(
         new FileInputStream("large.txt"))) {
    while (bis.read() != -1) {
        // å†…éƒ¨ä½¿ç”¨ç¼“å†²åŒºï¼Œå‡å°‘ç³»ç»Ÿè°ƒç”¨
    }
}
long time2 = System.currentTimeMillis() - start;

System.out.println("æ— ç¼“å†²: " + time1 + "ms");
System.out.println("æœ‰ç¼“å†²: " + time2 + "ms");
// æœ‰ç¼“å†²é€šå¸¸å¿«10-100å€
```

### 2ï¸âƒ£ ä½¿ç”¨å­—èŠ‚æ•°ç»„æ‰¹é‡è¯»å†™

```java
// âŒ æ…¢ï¼šé€å­—èŠ‚è¯»å†™
try (FileInputStream fis = new FileInputStream("source.dat");
     FileOutputStream fos = new FileOutputStream("dest.dat")) {
    int b;
    while ((b = fis.read()) != -1) {
        fos.write(b);
    }
}

// âœ… å¿«ï¼šä½¿ç”¨å­—èŠ‚æ•°ç»„
try (FileInputStream fis = new FileInputStream("source.dat");
     FileOutputStream fos = new FileOutputStream("dest.dat")) {
    byte[] buffer = new byte[8192];  // 8KBç¼“å†²åŒº
    int length;
    while ((length = fis.read(buffer)) > 0) {
        fos.write(buffer, 0, length);
    }
}
```

### 3ï¸âƒ£ é€‰æ‹©åˆé€‚çš„ç¼“å†²åŒºå¤§å°

```java
// ä¸åŒç¼“å†²åŒºå¤§å°çš„æ€§èƒ½æµ‹è¯•
int[] bufferSizes = {512, 1024, 2048, 4096, 8192, 16384};

for (int size : bufferSizes) {
    long start = System.currentTimeMillis();
    try (FileInputStream fis = new FileInputStream("large.dat");
         FileOutputStream fos = new FileOutputStream("copy.dat")) {
        byte[] buffer = new byte[size];
        int length;
        while ((length = fis.read(buffer)) > 0) {
            fos.write(buffer, 0, length);
        }
    }
    long time = System.currentTimeMillis() - start;
    System.out.println("ç¼“å†²åŒº " + size + " å­—èŠ‚: " + time + "ms");
}
```

> ğŸ’¡ **æ¨èç¼“å†²åŒºå¤§å°**: 4KB-8KBé€šå¸¸æ˜¯æœ€ä½³é€‰æ‹©

### 4ï¸âƒ£ ä½¿ç”¨NIO (New I/O)è¿›è¡Œå¤§æ–‡ä»¶æ“ä½œ

```java
import java.nio.file.*;
import java.nio.channels.*;

// ä½¿ç”¨FileChannelè¿›è¡Œé«˜æ•ˆå¤åˆ¶
public static void fastCopy(String source, String dest) throws IOException {
    try (FileChannel srcChannel = FileChannel.open(
             Paths.get(source), StandardOpenOption.READ);
         FileChannel destChannel = FileChannel.open(
             Paths.get(dest), StandardOpenOption.WRITE, 
             StandardOpenOption.CREATE)) {
        
        // ç›´æ¥ä¼ è¾“ï¼Œæ•ˆç‡æœ€é«˜
        destChannel.transferFrom(srcChannel, 0, srcChannel.size());
    }
}
```

---

## ğŸ“ å®æˆ˜ç»ƒä¹ é¢˜

### ç»ƒä¹ 1: æ–‡ä»¶ç»Ÿè®¡å·¥å…·

**éœ€æ±‚**: ç¼–å†™ç¨‹åºç»Ÿè®¡æ–‡æœ¬æ–‡ä»¶çš„è¡Œæ•°ã€å•è¯æ•°ã€å­—ç¬¦æ•°

```java
import java.io.*;

public class FileStatistics {
    public static void main(String[] args) {
        String filename = "test.txt";
        int lines = 0, words = 0, chars = 0;
        
        try (BufferedReader br = new BufferedReader(
                 new FileReader(filename))) {
            String line;
            while ((line = br.readLine()) != null) {
                lines++;
                chars += line.length();
                String[] wordArray = line.split("\\s+");
                words += wordArray.length;
            }
            
            System.out.println("è¡Œæ•°: " + lines);
            System.out.println("å•è¯æ•°: " + words);
            System.out.println("å­—ç¬¦æ•°: " + chars);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

### ç»ƒä¹ 2: æ–‡æœ¬æ–‡ä»¶åŠ å¯†/è§£å¯†

**éœ€æ±‚**: ä½¿ç”¨ç®€å•çš„å¼‚æˆ–åŠ å¯†ç®—æ³•åŠ å¯†æ–‡æœ¬æ–‡ä»¶

```java
import java.io.*;

public class FileEncryption {
    private static final int KEY = 123;  // åŠ å¯†å¯†é’¥
    
    // åŠ å¯†
    public static void encrypt(String source, String dest) {
        try (FileInputStream fis = new FileInputStream(source);
             FileOutputStream fos = new FileOutputStream(dest)) {
            int data;
            while ((data = fis.read()) != -1) {
                fos.write(data ^ KEY);  // å¼‚æˆ–åŠ å¯†
            }
            System.out.println("åŠ å¯†å®Œæˆ!");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    // è§£å¯†ï¼ˆå¼‚æˆ–åŠ å¯†çš„ç‰¹æ€§ï¼šåŠ å¯†ä¸¤æ¬¡ç­‰äºè§£å¯†ï¼‰
    public static void decrypt(String source, String dest) {
        encrypt(source, dest);  // è§£å¯†æ–¹æ³•ä¸åŠ å¯†ç›¸åŒ
        System.out.println("è§£å¯†å®Œæˆ!");
    }
    
    public static void main(String[] args) {
        encrypt("original.txt", "encrypted.txt");
        decrypt("encrypted.txt", "decrypted.txt");
    }
}
```

### ç»ƒä¹ 3: å­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ

**éœ€æ±‚**: å°†å­¦ç”Ÿå¯¹è±¡åºåˆ—åŒ–ä¿å­˜åˆ°æ–‡ä»¶ï¼Œå¹¶èƒ½è¯»å–

```java
import java.io.*;
import java.util.*;

class Student implements Serializable {
    private static final long serialVersionUID = 1L;
    private String id;
    private String name;
    private int age;
    
    public Student(String id, String name, int age) {
        this.id = id;
        this.name = name;
        this.age = age;
    }
    
    @Override
    public String toString() {
        return "å­¦å·: " + id + ", å§“å: " + name + ", å¹´é¾„: " + age;
    }
}

public class StudentManager {
    // ä¿å­˜å­¦ç”Ÿåˆ—è¡¨
    public static void saveStudents(List<Student> students, String filename) {
        try (ObjectOutputStream oos = new ObjectOutputStream(
                 new FileOutputStream(filename))) {
            oos.writeObject(students);
            System.out.println("ä¿å­˜æˆåŠŸ!");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    // è¯»å–å­¦ç”Ÿåˆ—è¡¨
    @SuppressWarnings("unchecked")
    public static List<Student> loadStudents(String filename) {
        try (ObjectInputStream ois = new ObjectInputStream(
                 new FileInputStream(filename))) {
            return (List<Student>) ois.readObject();
        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
            return new ArrayList<>();
        }
    }
    
    public static void main(String[] args) {
        // åˆ›å»ºå­¦ç”Ÿåˆ—è¡¨
        List<Student> students = new ArrayList<>();
        students.add(new Student("001", "å¼ ä¸‰", 20));
        students.add(new Student("002", "æå››", 21));
        students.add(new Student("003", "ç‹äº”", 19));
        
        // ä¿å­˜
        saveStudents(students, "students.dat");
        
        // è¯»å–
        List<Student> loaded = loadStudents("students.dat");
        System.out.println("\nè¯»å–çš„å­¦ç”Ÿä¿¡æ¯:");
        for (Student s : loaded) {
            System.out.println(s);
        }
    }
}
```

### ç»ƒä¹ 4: æ—¥å¿—æ–‡ä»¶åˆ†æå™¨

**éœ€æ±‚**: åˆ†ææ—¥å¿—æ–‡ä»¶ï¼Œç»Ÿè®¡ERRORå’ŒWARNINGçš„æ•°é‡

```java
import java.io.*;
import java.util.*;

public class LogAnalyzer {
    public static void main(String[] args) {
        String logFile = "application.log";
        int errorCount = 0;
        int warningCount = 0;
        List<String> errors = new ArrayList<>();
        
        try (BufferedReader br = new BufferedReader(
                 new FileReader(logFile))) {
            String line;
            while ((line = br.readLine()) != null) {
                if (line.contains("ERROR")) {
                    errorCount++;
                    errors.add(line);
                } else if (line.contains("WARNING")) {
                    warningCount++;
                }
            }
            
            System.out.println("=== æ—¥å¿—åˆ†æç»“æœ ===");
            System.out.println("ERRORæ•°é‡: " + errorCount);
            System.out.println("WARNINGæ•°é‡: " + warningCount);
            System.out.println("\nERRORè¯¦æƒ…:");
            for (String error : errors) {
                System.out.println(error);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

### ç»ƒä¹ 5: å¤§æ–‡ä»¶åˆ†å‰²ä¸åˆå¹¶

**éœ€æ±‚**: å°†å¤§æ–‡ä»¶åˆ†å‰²æˆå¤šä¸ªå°æ–‡ä»¶ï¼Œå¹¶èƒ½åˆå¹¶å›åŸæ–‡ä»¶

```java
import java.io.*;

public class FileSplitter {
    // åˆ†å‰²æ–‡ä»¶
    public static void splitFile(String sourceFile, int partSize) {
        try (FileInputStream fis = new FileInputStream(sourceFile)) {
            byte[] buffer = new byte[partSize];
            int partNum = 1;
            int bytesRead;
            
            while ((bytesRead = fis.read(buffer)) > 0) {
                String partFile = sourceFile + ".part" + partNum;
                try (FileOutputStream fos = new FileOutputStream(partFile)) {
                    fos.write(buffer, 0, bytesRead);
                }
                System.out.println("åˆ›å»º: " + partFile);
                partNum++;
            }
            System.out.println("åˆ†å‰²å®Œæˆï¼Œå…±" + (partNum - 1) + "ä¸ªæ–‡ä»¶");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    // åˆå¹¶æ–‡ä»¶
    public static void mergeFiles(String baseFile, String outputFile, int parts) {
        try (FileOutputStream fos = new FileOutputStream(outputFile)) {
            for (int i = 1; i <= parts; i++) {
                String partFile = baseFile + ".part" + i;
                try (FileInputStream fis = new FileInputStream(partFile)) {
                    byte[] buffer = new byte[8192];
                    int bytesRead;
                    while ((bytesRead = fis.read(buffer)) > 0) {
                        fos.write(buffer, 0, bytesRead);
                    }
                }
                System.out.println("åˆå¹¶: " + partFile);
            }
            System.out.println("åˆå¹¶å®Œæˆ: " + outputFile);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    public static void main(String[] args) {
        // åˆ†å‰²æ–‡ä»¶ï¼ˆæ¯éƒ¨åˆ†1MBï¼‰
        splitFile("large.dat", 1024 * 1024);
        
        // åˆå¹¶æ–‡ä»¶
        mergeFiles("large.dat", "merged.dat", 3);
    }
}
```

---

## ğŸ—‚ï¸ çŸ¥è¯†ä½“ç³»æ€»ç»“

```mermaid
mindmap
  root((Java I/Oæµ))
    åŸºç¡€æ¦‚å¿µ
      è¾“å…¥æµæº
      è¾“å‡ºæµç›®çš„åœ°
      4å¤§æŠ½è±¡ç±»
        InputStream
        OutputStream
        Reader
        Writer
    æ–‡ä»¶æ“ä½œ
      Fileç±»
        å±æ€§æ–¹æ³•
        ç›®å½•æ“ä½œ
        åˆ›å»ºåˆ é™¤
      Scannerè§£æ
        é»˜è®¤åˆ†éš”ç¬¦
        æ­£åˆ™è¡¨è¾¾å¼
    å­—ç¬¦æµ
      FileReader Writer
      BufferedReader Writer
        é€è¡Œè¯»å–
    å­—èŠ‚æµ
      FileInputStream OutputStream
      DataInputStream OutputStream
        åŸºæœ¬ç±»å‹è¯»å†™
      ObjectInputStream OutputStream
        å¯¹è±¡è¯»å†™
        åºåˆ—åŒ–
    é«˜çº§ç‰¹æ€§
      æ•°ç»„æµ
        ByteArray
        CharArray
      å­—ç¬¦ä¸²æµ
        StringReader Writer
      RandomAccessFile
        éšæœºè¯»å†™
        æ–‡ä»¶æŒ‡é’ˆ
      æ–‡ä»¶é”
        FileLock
        FileChannel
```

### ğŸ“‹ ä½¿ç”¨å»ºè®®

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ |
|------|---------|
| è¯»å–æ–‡æœ¬æ–‡ä»¶ | FileReader + BufferedReader |
| å†™å…¥æ–‡æœ¬æ–‡ä»¶ | FileWriter + BufferedWriter |
| è§£ææ–‡æœ¬æ–‡ä»¶ | Scanner |
| è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ | FileInputStream + BufferedInputStream |
| å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ | FileOutputStream + BufferedOutputStream |
| è¯»å†™åŸºæœ¬ç±»å‹ | DataInputStream/DataOutputStream |
| è¯»å†™å¯¹è±¡ | ObjectInputStream/ObjectOutputStream |
| éšæœºè¯»å†™ | RandomAccessFile |
| å†…å­˜æ“ä½œ | ByteArrayStream/CharArrayStream |
| å­—ç¬¦ä¸²æ“ä½œ | StringReader/StringWriter |
| å¹¶å‘è®¿é—®æ–‡ä»¶ | RandomAccessFile + FileLock |

> ğŸ’¡ **æ€»ä½“åŸåˆ™**: 
> - æ–‡æœ¬æ•°æ® â†’ ä½¿ç”¨å­—ç¬¦æµ (Reader/Writer)
> - äºŒè¿›åˆ¶æ•°æ® â†’ ä½¿ç”¨å­—èŠ‚æµ (InputStream/OutputStream)
> - æ€»æ˜¯ä½¿ç”¨ç¼“å†²æµæé«˜æ•ˆç‡
> - åŠæ—¶å…³é—­æµé‡Šæ”¾èµ„æº
